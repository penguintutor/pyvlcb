
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../spec/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Reference - PyVLCB</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pyvlcb.VLCB" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PyVLCB" class="md-header__button md-logo" aria-label="PyVLCB" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyVLCB
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PyVLCB" class="md-nav__button md-logo" aria-label="PyVLCB" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PyVLCB
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB" class="md-nav__link">
    <span class="md-ellipsis">
      
        VLCB
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.accessory_command" class="md-nav__link">
    <span class="md-ellipsis">
      
        accessory_command
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.accessory_long_command" class="md-nav__link">
    <span class="md-ellipsis">
      
        accessory_long_command
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.accessory_short_command" class="md-nav__link">
    <span class="md-ellipsis">
      
        accessory_short_command
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.allocate_loco" class="md-nav__link">
    <span class="md-ellipsis">
      
        allocate_loco
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.discover" class="md-nav__link">
    <span class="md-ellipsis">
      
        discover
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.discover_evn" class="md-nav__link">
    <span class="md-ellipsis">
      
        discover_evn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.discover_nerd" class="md-nav__link">
    <span class="md-ellipsis">
      
        discover_nerd
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.discover_nevn" class="md-nav__link">
    <span class="md-ellipsis">
      
        discover_nevn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.keep_alive" class="md-nav__link">
    <span class="md-ellipsis">
      
        keep_alive
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_set_dfun" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_set_dfun
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_set_function" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_set_function
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_speed_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_speed_dir
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_speeddir" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_speeddir
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_stop_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_stop_all
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.log_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        log_entry
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.make_header" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_header
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.parse_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_input
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.release_loco" class="md-nav__link">
    <span class="md-ellipsis">
      
        release_loco
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.share_loco" class="md-nav__link">
    <span class="md-ellipsis">
      
        share_loco
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.steal_loco" class="md-nav__link">
    <span class="md-ellipsis">
      
        steal_loco
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4" class="md-nav__link">
    <span class="md-ellipsis">
      
        CanUSB4
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4.connect" class="md-nav__link">
    <span class="md-ellipsis">
      
        connect
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4.read_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4.send_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        send_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat" class="md-nav__link">
    <span class="md-ellipsis">
      
        VLCBFormat
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.format_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        format_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.get_function_list" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_function_list
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.get_loco_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_loco_id
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.opcode" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode" class="md-nav__link">
    <span class="md-ellipsis">
      
        VLCBOpcode
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.opcode_extract" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode_extract
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.opcode_mnemonic" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode_mnemonic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.opcode_priority" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode_priority
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.opcode_title" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode_title
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.parse_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.bytes_to_addr" class="md-nav__link">
    <span class="md-ellipsis">
      
        bytes_to_addr
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.bytes_to_functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        bytes_to_functions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.bytes_to_hexstr" class="md-nav__link">
    <span class="md-ellipsis">
      
        bytes_to_hexstr
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.dict_to_string" class="md-nav__link">
    <span class="md-ellipsis">
      
        dict_to_string
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.f_to_bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        f_to_bytes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.num_to_1hexstr" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_to_1hexstr
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.num_to_2hexstr" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_to_2hexstr
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.num_to_4hexstr" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_to_4hexstr
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../spec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VLCB specs
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB" class="md-nav__link">
    <span class="md-ellipsis">
      
        VLCB
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.accessory_command" class="md-nav__link">
    <span class="md-ellipsis">
      
        accessory_command
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.accessory_long_command" class="md-nav__link">
    <span class="md-ellipsis">
      
        accessory_long_command
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.accessory_short_command" class="md-nav__link">
    <span class="md-ellipsis">
      
        accessory_short_command
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.allocate_loco" class="md-nav__link">
    <span class="md-ellipsis">
      
        allocate_loco
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.discover" class="md-nav__link">
    <span class="md-ellipsis">
      
        discover
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.discover_evn" class="md-nav__link">
    <span class="md-ellipsis">
      
        discover_evn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.discover_nerd" class="md-nav__link">
    <span class="md-ellipsis">
      
        discover_nerd
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.discover_nevn" class="md-nav__link">
    <span class="md-ellipsis">
      
        discover_nevn
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.keep_alive" class="md-nav__link">
    <span class="md-ellipsis">
      
        keep_alive
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_set_dfun" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_set_dfun
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_set_function" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_set_function
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_speed_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_speed_dir
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_speeddir" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_speeddir
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.loco_stop_all" class="md-nav__link">
    <span class="md-ellipsis">
      
        loco_stop_all
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.log_entry" class="md-nav__link">
    <span class="md-ellipsis">
      
        log_entry
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.make_header" class="md-nav__link">
    <span class="md-ellipsis">
      
        make_header
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.parse_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_input
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.release_loco" class="md-nav__link">
    <span class="md-ellipsis">
      
        release_loco
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.share_loco" class="md-nav__link">
    <span class="md-ellipsis">
      
        share_loco
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCB.steal_loco" class="md-nav__link">
    <span class="md-ellipsis">
      
        steal_loco
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4" class="md-nav__link">
    <span class="md-ellipsis">
      
        CanUSB4
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4.connect" class="md-nav__link">
    <span class="md-ellipsis">
      
        connect
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4.read_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.CanUSB4.send_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        send_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat" class="md-nav__link">
    <span class="md-ellipsis">
      
        VLCBFormat
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.format_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        format_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.get_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.get_function_list" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_function_list
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.get_loco_id" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_loco_id
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBFormat.opcode" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode" class="md-nav__link">
    <span class="md-ellipsis">
      
        VLCBOpcode
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.opcode_extract" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode_extract
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.opcode_mnemonic" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode_mnemonic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.opcode_priority" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode_priority
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.opcode_title" class="md-nav__link">
    <span class="md-ellipsis">
      
        opcode_title
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.VLCBOpcode.parse_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils" class="md-nav__link">
    <span class="md-ellipsis">
      
        utils
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.bytes_to_addr" class="md-nav__link">
    <span class="md-ellipsis">
      
        bytes_to_addr
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.bytes_to_functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        bytes_to_functions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.bytes_to_hexstr" class="md-nav__link">
    <span class="md-ellipsis">
      
        bytes_to_hexstr
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.dict_to_string" class="md-nav__link">
    <span class="md-ellipsis">
      
        dict_to_string
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.f_to_bytes" class="md-nav__link">
    <span class="md-ellipsis">
      
        f_to_bytes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.num_to_1hexstr" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_to_1hexstr
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.num_to_2hexstr" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_to_2hexstr
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyvlcb.utils.num_to_4hexstr" class="md-nav__link">
    <span class="md-ellipsis">
      
        num_to_4hexstr
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Reference</h1>

<div class="doc doc-object doc-class">



<a id="pyvlcb.VLCB"></a>
    <div class="doc doc-contents first">



        <p>Handle VLCB formatting</p>
<p>It generates the appropriate strings which can be sent to CBUS / VLCB</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pyvlcb.VLCB.can_id">can_id</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Can ID for your software (default = 60)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">VLCB</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle VLCB formatting</span>

<span class="sd">    It generates the appropriate strings which can be sent to CBUS / VLCB</span>

<span class="sd">    Attributes:</span>
<span class="sd">        can_id: The Can ID for your software (default = 60)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 60 is default canid for canusb4 (127 is dcc controller)</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">can_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits VLCB with a can_id</span>

<span class="sd">        Args:</span>
<span class="sd">            can_id: The can_id for the software (default = 60)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">can_id</span> <span class="o">=</span> <span class="n">can_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Takes input bytestring and parses header / data</span>
    <span class="c1"># Does not try and interpret op-code - that is left to VLCB_format</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parse_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_bytes</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VLCBFormat</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse a raw CBUS packet as an input bytestring</span>

<span class="sd">        Take a bytestring (or string) from the CBUS and extract the details</span>

<span class="sd">        Args: </span>
<span class="sd">            input_types (bytestring): Input raw bytestring (or string)</span>

<span class="sd">        Returns:</span>
<span class="sd">            VLCBFormat: parsed data in VLCBFormat</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If invalid data string</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Also allow string (no need to decode)</span>
        <span class="k">if</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">input_bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">input_string</span> <span class="o">=</span> <span class="n">input_bytes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">input_string</span> <span class="o">=</span> <span class="n">input_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_string</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">):</span>        <span class="c1"># packets are actually much longer</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;input_bytes &#39;</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s2">&#39; is too short.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">input_string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;:&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No start frame in &#39;</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">input_string</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;S&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Format not supported - only Standard frames allowed in </span><span class="si">{input_string}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Use try when converting to number in case of error</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="n">input_string</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">header_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid format, number expected </span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">header_val</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Header </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">header_val</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">priority</span> <span class="o">=</span> <span class="p">(</span><span class="n">header_val</span> <span class="o">&amp;</span> <span class="mh">0xf000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Priority </span><span class="si">{</span><span class="n">priority</span><span class="si">:</span><span class="s2">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">can_id</span> <span class="o">=</span> <span class="p">(</span><span class="n">header_val</span> <span class="o">&amp;</span> <span class="mh">0xfe0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can ID </span><span class="si">{</span><span class="n">can_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Next is N / RTR can be ignored</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N / RTR </span><span class="si">{</span><span class="n">input_string</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Data is rest excluding ; </span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">input_string</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Creates a VLCB_format and returns that</span>
        <span class="k">return</span> <span class="n">VLCBFormat</span> <span class="p">(</span><span class="n">priority</span><span class="p">,</span> <span class="n">can_id</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="c1"># Parse and format into standard log format (datastring, direction, fulldata, direction, can_id, op_code, data</span>
    <span class="c1"># For log all values are returned as strings - note that the number (log entry number) is not returned</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">log_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse a log entry and return as a list of string values</span>

<span class="sd">        Args:</span>
<span class="sd">            input_string (string): String consisting of of num, date, direction, message as a single string</span>

<span class="sd">        Returns (list[str]): List of strings</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># First remove number and date from the front of the string</span>
        <span class="n">entry_parts</span> <span class="o">=</span> <span class="n">input_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">date_string</span> <span class="o">=</span> <span class="n">entry_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="n">entry_parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">entry_parts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">vlcb_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_input</span> <span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="c1"># Error handling of invalid packet</span>
        <span class="k">if</span> <span class="n">vlcb_entry</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">message</span><span class="p">,</span> <span class="s2">&quot;??&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Invalid data&quot;</span><span class="p">]</span>
        <span class="c1"># convert op-code to string</span>
        <span class="c1"># opcode is first two chars of data</span>
        <span class="n">opcode</span> <span class="o">=</span> <span class="n">vlcb_entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">opcode_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">opcode</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_mnemonic</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="c1">#data_string = f&quot;{VLCBOpcode.parse_data(vlcb_entry.data)}&quot;</span>
        <span class="n">data_string</span> <span class="o">=</span> <span class="n">dict_to_string</span><span class="p">(</span><span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="n">vlcb_entry</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">date_string</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">vlcb_entry</span><span class="o">.</span><span class="n">can_id</span><span class="p">),</span> <span class="n">opcode_string</span><span class="p">,</span> <span class="n">data_string</span><span class="p">]</span>
        <span class="c1"># Todo - error handling </span>


    <span class="c1"># Static Methods moved to utils</span>
    <span class="c1">#num_to_1hexstr = staticmethod(num_to_1hexstr)</span>
    <span class="c1">#num_to_2hexstr = staticmethod(num_to_2hexstr)</span>
    <span class="c1">#num_to_4hexstr = staticmethod(num_to_4hexstr)</span>


    <span class="c1"># Create header using low priority and can_id (or self.can_id)</span>
    <span class="c1"># If opcode provided, but no priority then appropriate min code looked up</span>
    <span class="c1"># MajPri would be based on packet aging - needs to be managed outside of this</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">make_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                <span class="n">majpri</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mb">0b10</span><span class="p">,</span> 
                <span class="n">minpri</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                <span class="n">can_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                <span class="n">opcode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a CBUS/VLCB header</span>

<span class="sd">        Args:</span>
<span class="sd">            byte1 (byte): Most significant byte</span>
<span class="sd">            byte2 (byte): Least significant byte</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A hex representation of the number</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">can_id</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">can_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_id</span>

        <span class="k">if</span> <span class="n">minpri</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">opcode</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minpri</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_priority</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span>

        <span class="c1"># If opcode not updated then use default low priority</span>
        <span class="c1"># Lower number is higher priority</span>
        <span class="k">if</span> <span class="n">minpri</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minpri</span> <span class="o">=</span> <span class="mb">0b11</span>

        <span class="n">header_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">majpri</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">minpri</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">can_id</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span>
        <span class="n">header_to_hex</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;000&quot;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">header_val</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[</span><span class="mi">2</span><span class="p">:])[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>
        <span class="n">header_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;:S</span><span class="si">{</span><span class="n">header_to_hex</span><span class="si">}</span><span class="s1">N&#39;</span>
        <span class="k">return</span> <span class="n">header_string</span>
        <span class="c1">#return header_string.encode(&#39;utf-8&#39;)</span>


    <span class="c1"># Discover nodes</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">discover</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a discovery string </span>

<span class="sd">        Uses op-code QNN (0D)</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Return QNN </span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;0D&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;0D;&#39;</span>

    <span class="c1"># Discover number of events configured</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">discover_evn</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a discover number of events for a node</span>

<span class="sd">        Uses op-code RQEVN (58)</span>

<span class="sd">        Args:</span>
<span class="sd">            node_id (int): Node ID to query</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;58&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">58</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span> 

    <span class="c1"># Discover number of events available</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">discover_nevn</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a discover number of events available for a node</span>

<span class="sd">        Uses op-code NNEVN (56)</span>

<span class="sd">        Args:</span>
<span class="sd">            node_id (int): Node ID to query</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;56&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">56</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>

    <span class="c1"># Discover stored events NERD</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">discover_nerd</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a discover stored events for a node</span>

<span class="sd">        Uses op-code NERD (57)</span>

<span class="sd">        Args:</span>
<span class="sd">            node_id (int): Node ID to query</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;57&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">57</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>

    <span class="c1"># Emergency stop all locos</span>
    <span class="c1"># RESTP</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">loco_stop_all</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an emergency stop all locos</span>

<span class="sd">        Uses op-code RESTP (0A)</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;0A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">0A;&quot;</span>

    <span class="c1"># node and ev should be the IDs - state either &quot;on&quot; or &quot;off&quot; / True or False</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">accessory_command</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an accessory command</span>

<span class="sd">        Uses appropriate Accessory On / Off command</span>
<span class="sd">        Defaulting to short, but using long if &gt; 0xffff</span>

<span class="sd">        Args:</span>
<span class="sd">            node_id: Node ID to query</span>
<span class="sd">            ev_id: Event ID</span>
<span class="sd">            state: State to change to can be &quot;on&quot; or &quot;off&quot; / True or False</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if ev_id is a string then convert to an int</span>
        <span class="c1"># Setting based to 0 will automatically handle base 10 or hex</span>
        <span class="n">ev_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ev_id</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># determine if long or short</span>
        <span class="k">if</span> <span class="n">ev_id</span> <span class="o">&lt;=</span> <span class="mh">0xffff</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">accessory_short_command</span> <span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">accessory_long_command</span> <span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>

    <span class="c1"># Note that short is the same as long but different code and node_id is added (already included in long)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">accessory_short_command</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an accessory short command</span>

<span class="sd">        Uses ASON (98) or ASOF (99)</span>

<span class="sd">        Args:</span>
<span class="sd">            node_id: Node ID to query</span>
<span class="sd">            ev_id: Event ID</span>
<span class="sd">            state: State to change to can be &quot;on&quot; or &quot;off&quot; / True or False</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Turn on</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">:</span>
            <span class="c1"># ASON</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;98&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">98</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">ev_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
        <span class="c1"># Turn off = ASOFF</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;99&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">99</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">ev_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">accessory_long_command</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an accessory long command</span>

<span class="sd">        Uses ACON (90) or ACOF (91)</span>

<span class="sd">        Args:</span>
<span class="sd">            node_id: Node ID to query</span>
<span class="sd">            ev_id: Event ID</span>
<span class="sd">            state: State to change to can be &quot;on&quot; or &quot;off&quot; / True or False</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Turn on</span>
        <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">:</span>
            <span class="c1"># ASON</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;90&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">90</span><span class="si">{</span><span class="n">num_to_4hexstr</span><span class="p">(</span><span class="n">ev_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
        <span class="c1"># Turn off = ASOFF</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;91&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">91</span><span class="si">{</span><span class="n">num_to_4hexstr</span><span class="p">(</span><span class="n">ev_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>

    <span class="c1"># RLOC (Allocate loco) :SB040N40D446;</span>
    <span class="c1"># Short address upper address all zeros, only 6 bits of the lower byte are used (1 to 127) 0 is decoderless</span>
    <span class="c1"># :SB040N40D446 D446 becomes 5190(10) = 1446(H) + C000 (highest 2 bits set by CAB - indicate long mode)</span>

    <span class="c1"># Generate code to allocate a loco</span>
    <span class="c1"># Assume long code, but if long = False and ID &lt; 128 then use short mode</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">allocate_loco</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loco_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an allocate loco request</span>

<span class="sd">        Uses RLOC (40)</span>

<span class="sd">        Args:</span>
<span class="sd">            loco_id: Loco ID (long or short number)</span>
<span class="sd">            long: Long loco ID (True) or short loco ID (False)</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Generate RLOC to allocate loco to a session</span>
        <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">loco_id</span> <span class="o">&gt;=</span> <span class="mi">127</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span> <span class="p">(</span><span class="s2">&quot;Invalid short code. Loco ID </span><span class="si">{loco_id}</span><span class="s2"> is larger than 127&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">loco_id</span> <span class="o">=</span> <span class="n">loco_id</span> <span class="o">|</span> <span class="mh">0xC000</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;40&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">40</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">loco_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">release_loco</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a release loco request</span>

<span class="sd">        Uses KLOC (21)</span>

<span class="sd">        Args:</span>
<span class="sd">            session_id: Session number</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;21&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">21</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">steal_loco</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loco_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an steal loco request</span>

<span class="sd">        Takes the loco and other connectons to the loco should be terminated.        </span>
<span class="sd">        Uses GLOC (60)</span>

<span class="sd">        Args:</span>
<span class="sd">            loco_id: Loco ID (long or short number)</span>
<span class="sd">            long: Long loco ID (True) or short loco ID (False)</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidLocoError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># GLOC 61 - flag = 1 for steal, flag = for share</span>
        <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">loco_id</span> <span class="o">&gt;=</span> <span class="mi">127</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidLocoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid short code </span><span class="si">{</span><span class="n">loco_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">loco_id</span> <span class="o">=</span> <span class="n">loco_id</span> <span class="o">|</span> <span class="mh">0xC000</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;61&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">61</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">loco_id</span><span class="p">)</span><span class="si">}</span><span class="s2">01;&quot;</span>   

    <span class="k">def</span><span class="w"> </span><span class="nf">share_loco</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loco_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an share loco request</span>

<span class="sd">        Takes the loco and other connectons to the loco can remain.</span>
<span class="sd">        Uses GLOC (61)</span>

<span class="sd">        Args:</span>
<span class="sd">            loco_id: Loco ID (long or short number)</span>
<span class="sd">            long: Long loco ID (True) or short loco ID (False)</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidLocoError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># GLOC 61 - flag = 1 for steal, flag = for share</span>
        <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">loco_id</span> <span class="o">&gt;=</span> <span class="mi">127</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidLocoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid short code </span><span class="si">{</span><span class="n">loco_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">loco_id</span> <span class="o">=</span> <span class="n">loco_id</span> <span class="o">|</span> <span class="mh">0xC000</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;61&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">61</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">loco_id</span><span class="p">)</span><span class="si">}</span><span class="s2">02;&quot;</span> 

    <span class="k">def</span><span class="w"> </span><span class="nf">keep_alive</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an keep alive request</span>

<span class="sd">        For any loco allocated send a keep alive at least every 4 seconds</span>
<span class="sd">        Uses DKEEP (23)</span>

<span class="sd">        Args:</span>
<span class="sd">            session_id: Session ID </span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;23&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">23</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">loco_speed_dir</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">speed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set loco speed and direction based on separate arguments</span>

<span class="sd">        Same as loco_speeddir but this takes 2 arguments, whereas loco_speeddir needs a combined value</span>
<span class="sd">        Maximum call this once every 32 milliseconds</span>

<span class="sd">        Uses DSPD (47)</span>

<span class="sd">        Args:</span>
<span class="sd">            session_id: Session ID</span>
<span class="sd">            speed: 0 to 127 (1 is increased to 2 to avoid emergency stop)</span>
<span class="sd">            direction: 1 = forward, 0 = reverse</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError is speed is out of range, or invalid direction</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">speed</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">speed</span> <span class="o">&gt;</span> <span class="mi">127</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span> <span class="p">(</span><span class="s2">&quot;Invalid speed specified. Must be in range 0 to 127&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">direction</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span> <span class="p">(</span><span class="s2">&quot;Direction is not valid. Use 1 for forward, 0 for reverse&quot;</span><span class="p">)</span>
        <span class="c1"># special case - ignore emergency stop</span>
        <span class="k">if</span> <span class="n">speed</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">speed</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">speeddir</span> <span class="o">=</span> <span class="p">(</span><span class="n">direction</span> <span class="o">*</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">+</span> <span class="n">speed</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loco_speeddir</span> <span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">speeddir</span><span class="p">)</span>

    <span class="c1"># Set loco speed and direction (always done together)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">loco_speeddir</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">speeddir</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set loco speed and direction</span>

<span class="sd">        Maximum call this once every 32 milliseconds</span>
<span class="sd">        Needs combined speed and direction value.</span>
<span class="sd">        If speed is set to 1 then that is considered an emergency stop</span>

<span class="sd">        Uses DSPD (47)</span>

<span class="sd">        Args:</span>
<span class="sd">            session_id: Session ID</span>
<span class="sd">            speeddir: Unsigned 8 bit number. MSB is direction, 7 bits for speed</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;47&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">47</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">speeddir</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>

    <span class="c1"># Set function using DFUN - needs to be provided with the two bytes</span>
    <span class="c1"># First byte is group (1 = F1 to F4, 2 = F5 to F8, 3 = F9 to F12)</span>
    <span class="c1"># 4 = F13 to 19, 5 = F20 to F28</span>
    <span class="c1"># Second byte is 1 bit per function - set 1 for on, 0 for off, lsb to right</span>
    <span class="c1"># eg. 1 = 0001, 2 = 0010</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">loco_set_dfun</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">byte1</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">byte2</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a set function request</span>

<span class="sd">        Uses DFUN (60)</span>

<span class="sd">        Args:</span>
<span class="sd">            session_id: Session ID</span>
<span class="sd">            byte1: Function group. 1 = F1 to F4, 2 = F5 to F8, 3 = F9 to F12, 4 = F13 to 19, 5 = F20 to F28</span>
<span class="sd">            byte2: 1 bit per function 1=on, 0=off. LSB to right eg 1 = 0001, 2 = 0010</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;60&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">60</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">byte1</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">byte2</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">loco_set_function</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">function_num</span><span class="p">,</span> <span class="n">function_list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a set function request using the function list</span>
<span class="sd">        Sends the entire group of functions where the function_num resides</span>
<span class="sd">        This is an alternative to loco_set_dfun as this calculates the bytes</span>
<span class="sd">        this method can only be used for functions 0 to 27</span>

<span class="sd">        Uses DFUN (60)</span>

<span class="sd">        Args:</span>
<span class="sd">            session_id: Session ID</span>
<span class="sd">            byte1: Function number</span>
<span class="sd">            byte2: List of current function statuses</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: A string for the request</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Typically raised from f_to_bytes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">byte1_2</span> <span class="o">=</span> <span class="n">f_to_bytes</span><span class="p">(</span><span class="n">function_num</span><span class="p">,</span> <span class="n">function_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;60&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">60</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}{</span><span class="n">byte1_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="n">byte1_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">can_id</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inits VLCB with a can_id</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>can_id</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The can_id for the software (default = 60)</p>
              </div>
            </td>
            <td>
                  <code>60</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">can_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits VLCB with a can_id</span>

<span class="sd">    Args:</span>
<span class="sd">        can_id: The can_id for the software (default = 60)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">can_id</span> <span class="o">=</span> <span class="n">can_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.accessory_command" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">accessory_command</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an accessory command</p>
<p>Uses appropriate Accessory On / Off command
Defaulting to short, but using long if &gt; 0xffff</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node ID to query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ev_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>State to change to can be "on" or "off" / True or False</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">accessory_command</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an accessory command</span>

<span class="sd">    Uses appropriate Accessory On / Off command</span>
<span class="sd">    Defaulting to short, but using long if &gt; 0xffff</span>

<span class="sd">    Args:</span>
<span class="sd">        node_id: Node ID to query</span>
<span class="sd">        ev_id: Event ID</span>
<span class="sd">        state: State to change to can be &quot;on&quot; or &quot;off&quot; / True or False</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if ev_id is a string then convert to an int</span>
    <span class="c1"># Setting based to 0 will automatically handle base 10 or hex</span>
    <span class="n">ev_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ev_id</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c1"># determine if long or short</span>
    <span class="k">if</span> <span class="n">ev_id</span> <span class="o">&lt;=</span> <span class="mh">0xffff</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">accessory_short_command</span> <span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">accessory_long_command</span> <span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.accessory_long_command" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">accessory_long_command</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an accessory long command</p>
<p>Uses ACON (90) or ACOF (91)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node ID to query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ev_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>State to change to can be "on" or "off" / True or False</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">accessory_long_command</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an accessory long command</span>

<span class="sd">    Uses ACON (90) or ACOF (91)</span>

<span class="sd">    Args:</span>
<span class="sd">        node_id: Node ID to query</span>
<span class="sd">        ev_id: Event ID</span>
<span class="sd">        state: State to change to can be &quot;on&quot; or &quot;off&quot; / True or False</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Turn on</span>
    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">:</span>
        <span class="c1"># ASON</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;90&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">90</span><span class="si">{</span><span class="n">num_to_4hexstr</span><span class="p">(</span><span class="n">ev_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
    <span class="c1"># Turn off = ASOFF</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;91&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">91</span><span class="si">{</span><span class="n">num_to_4hexstr</span><span class="p">(</span><span class="n">ev_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.accessory_short_command" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">accessory_short_command</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an accessory short command</p>
<p>Uses ASON (98) or ASOF (99)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node ID to query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ev_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Event ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>state</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>State to change to can be "on" or "off" / True or False</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">accessory_short_command</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ev_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an accessory short command</span>

<span class="sd">    Uses ASON (98) or ASOF (99)</span>

<span class="sd">    Args:</span>
<span class="sd">        node_id: Node ID to query</span>
<span class="sd">        ev_id: Event ID</span>
<span class="sd">        state: State to change to can be &quot;on&quot; or &quot;off&quot; / True or False</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Turn on</span>
    <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;on&quot;</span><span class="p">:</span>
        <span class="c1"># ASON</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;98&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">98</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">ev_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
    <span class="c1"># Turn off = ASOFF</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;99&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">99</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">ev_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.allocate_loco" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">allocate_loco</span><span class="p">(</span><span class="n">loco_id</span><span class="p">,</span> <span class="n">long</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an allocate loco request</p>
<p>Uses RLOC (40)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>loco_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loco ID (long or short number)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>long</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Long loco ID (True) or short loco ID (False)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">allocate_loco</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loco_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an allocate loco request</span>

<span class="sd">    Uses RLOC (40)</span>

<span class="sd">    Args:</span>
<span class="sd">        loco_id: Loco ID (long or short number)</span>
<span class="sd">        long: Long loco ID (True) or short loco ID (False)</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate RLOC to allocate loco to a session</span>
    <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">loco_id</span> <span class="o">&gt;=</span> <span class="mi">127</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span> <span class="p">(</span><span class="s2">&quot;Invalid short code. Loco ID </span><span class="si">{loco_id}</span><span class="s2"> is larger than 127&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">loco_id</span> <span class="o">=</span> <span class="n">loco_id</span> <span class="o">|</span> <span class="mh">0xC000</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;40&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">40</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">loco_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.discover" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">discover</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a discovery string </p>
<p>Uses op-code QNN (0D)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">discover</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a discovery string </span>

<span class="sd">    Uses op-code QNN (0D)</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Return QNN </span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;0D&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;0D;&#39;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.discover_evn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">discover_evn</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a discover number of events for a node</p>
<p>Uses op-code RQEVN (58)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node ID to query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">discover_evn</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a discover number of events for a node</span>

<span class="sd">    Uses op-code RQEVN (58)</span>

<span class="sd">    Args:</span>
<span class="sd">        node_id (int): Node ID to query</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;58&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">58</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.discover_nerd" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">discover_nerd</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a discover stored events for a node</p>
<p>Uses op-code NERD (57)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node ID to query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">discover_nerd</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a discover stored events for a node</span>

<span class="sd">    Uses op-code NERD (57)</span>

<span class="sd">    Args:</span>
<span class="sd">        node_id (int): Node ID to query</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;57&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">57</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.discover_nevn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">discover_nevn</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a discover number of events available for a node</p>
<p>Uses op-code NNEVN (56)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Node ID to query</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">discover_nevn</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a discover number of events available for a node</span>

<span class="sd">    Uses op-code NNEVN (56)</span>

<span class="sd">    Args:</span>
<span class="sd">        node_id (int): Node ID to query</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;56&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">56</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">node_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.keep_alive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">keep_alive</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an keep alive request</p>
<p>For any loco allocated send a keep alive at least every 4 seconds
Uses DKEEP (23)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session ID </p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">keep_alive</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an keep alive request</span>

<span class="sd">    For any loco allocated send a keep alive at least every 4 seconds</span>
<span class="sd">    Uses DKEEP (23)</span>

<span class="sd">    Args:</span>
<span class="sd">        session_id: Session ID </span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;23&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">23</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.loco_set_dfun" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loco_set_dfun</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">byte1</span><span class="p">,</span> <span class="n">byte2</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a set function request</p>
<p>Uses DFUN (60)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>byte1</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function group. 1 = F1 to F4, 2 = F5 to F8, 3 = F9 to F12, 4 = F13 to 19, 5 = F20 to F28</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>byte2</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>1 bit per function 1=on, 0=off. LSB to right eg 1 = 0001, 2 = 0010</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">loco_set_dfun</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">byte1</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">byte2</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a set function request</span>

<span class="sd">    Uses DFUN (60)</span>

<span class="sd">    Args:</span>
<span class="sd">        session_id: Session ID</span>
<span class="sd">        byte1: Function group. 1 = F1 to F4, 2 = F5 to F8, 3 = F9 to F12, 4 = F13 to 19, 5 = F20 to F28</span>
<span class="sd">        byte2: 1 bit per function 1=on, 0=off. LSB to right eg 1 = 0001, 2 = 0010</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;60&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">60</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">byte1</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">byte2</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.loco_set_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loco_set_function</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">function_num</span><span class="p">,</span> <span class="n">function_list</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a set function request using the function list
Sends the entire group of functions where the function_num resides
This is an alternative to loco_set_dfun as this calculates the bytes
this method can only be used for functions 0 to 27</p>
<p>Uses DFUN (60)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>byte1</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function number</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>byte2</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of current function statuses</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Typically raised from f_to_bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">loco_set_function</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">function_num</span><span class="p">,</span> <span class="n">function_list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a set function request using the function list</span>
<span class="sd">    Sends the entire group of functions where the function_num resides</span>
<span class="sd">    This is an alternative to loco_set_dfun as this calculates the bytes</span>
<span class="sd">    this method can only be used for functions 0 to 27</span>

<span class="sd">    Uses DFUN (60)</span>

<span class="sd">    Args:</span>
<span class="sd">        session_id: Session ID</span>
<span class="sd">        byte1: Function number</span>
<span class="sd">        byte2: List of current function statuses</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Typically raised from f_to_bytes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">byte1_2</span> <span class="o">=</span> <span class="n">f_to_bytes</span><span class="p">(</span><span class="n">function_num</span><span class="p">,</span> <span class="n">function_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;60&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">60</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}{</span><span class="n">byte1_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}{</span><span class="n">byte1_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.loco_speed_dir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loco_speed_dir</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Set loco speed and direction based on separate arguments</p>
<p>Same as loco_speeddir but this takes 2 arguments, whereas loco_speeddir needs a combined value
Maximum call this once every 32 milliseconds</p>
<p>Uses DSPD (47)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>speed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>0 to 127 (1 is increased to 2 to avoid emergency stop)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>direction</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>1 = forward, 0 = reverse</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">loco_speed_dir</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">speed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set loco speed and direction based on separate arguments</span>

<span class="sd">    Same as loco_speeddir but this takes 2 arguments, whereas loco_speeddir needs a combined value</span>
<span class="sd">    Maximum call this once every 32 milliseconds</span>

<span class="sd">    Uses DSPD (47)</span>

<span class="sd">    Args:</span>
<span class="sd">        session_id: Session ID</span>
<span class="sd">        speed: 0 to 127 (1 is increased to 2 to avoid emergency stop)</span>
<span class="sd">        direction: 1 = forward, 0 = reverse</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError is speed is out of range, or invalid direction</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">speed</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">speed</span> <span class="o">&gt;</span> <span class="mi">127</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span> <span class="p">(</span><span class="s2">&quot;Invalid speed specified. Must be in range 0 to 127&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">direction</span> <span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">direction</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span> <span class="p">(</span><span class="s2">&quot;Direction is not valid. Use 1 for forward, 0 for reverse&quot;</span><span class="p">)</span>
    <span class="c1"># special case - ignore emergency stop</span>
    <span class="k">if</span> <span class="n">speed</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">speeddir</span> <span class="o">=</span> <span class="p">(</span><span class="n">direction</span> <span class="o">*</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">+</span> <span class="n">speed</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loco_speeddir</span> <span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">speeddir</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.loco_speeddir" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loco_speeddir</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="n">speeddir</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Set loco speed and direction</p>
<p>Maximum call this once every 32 milliseconds
Needs combined speed and direction value.
If speed is set to 1 then that is considered an emergency stop</p>
<p>Uses DSPD (47)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>speeddir</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unsigned 8 bit number. MSB is direction, 7 bits for speed</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">loco_speeddir</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">speeddir</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set loco speed and direction</span>

<span class="sd">    Maximum call this once every 32 milliseconds</span>
<span class="sd">    Needs combined speed and direction value.</span>
<span class="sd">    If speed is set to 1 then that is considered an emergency stop</span>

<span class="sd">    Uses DSPD (47)</span>

<span class="sd">    Args:</span>
<span class="sd">        session_id: Session ID</span>
<span class="sd">        speeddir: Unsigned 8 bit number. MSB is direction, 7 bits for speed</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;47&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">47</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">speeddir</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.loco_stop_all" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loco_stop_all</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an emergency stop all locos</p>
<p>Uses op-code RESTP (0A)</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">loco_stop_all</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an emergency stop all locos</span>

<span class="sd">    Uses op-code RESTP (0A)</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;0A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">0A;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.log_entry" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_entry</span><span class="p">(</span><span class="n">input_string</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parse a log entry and return as a list of string values</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_string</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>String consisting of of num, date, direction, message as a single string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns (list[str]): List of strings</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">log_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a log entry and return as a list of string values</span>

<span class="sd">    Args:</span>
<span class="sd">        input_string (string): String consisting of of num, date, direction, message as a single string</span>

<span class="sd">    Returns (list[str]): List of strings</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># First remove number and date from the front of the string</span>
    <span class="n">entry_parts</span> <span class="o">=</span> <span class="n">input_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">date_string</span> <span class="o">=</span> <span class="n">entry_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="n">entry_parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">entry_parts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">vlcb_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_input</span> <span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="c1"># Error handling of invalid packet</span>
    <span class="k">if</span> <span class="n">vlcb_entry</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">message</span><span class="p">,</span> <span class="s2">&quot;??&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Invalid data&quot;</span><span class="p">]</span>
    <span class="c1"># convert op-code to string</span>
    <span class="c1"># opcode is first two chars of data</span>
    <span class="n">opcode</span> <span class="o">=</span> <span class="n">vlcb_entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">opcode_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">opcode</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_mnemonic</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="c1">#data_string = f&quot;{VLCBOpcode.parse_data(vlcb_entry.data)}&quot;</span>
    <span class="n">data_string</span> <span class="o">=</span> <span class="n">dict_to_string</span><span class="p">(</span><span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="n">vlcb_entry</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">date_string</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">vlcb_entry</span><span class="o">.</span><span class="n">can_id</span><span class="p">),</span> <span class="n">opcode_string</span><span class="p">,</span> <span class="n">data_string</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.make_header" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">make_header</span><span class="p">(</span><span class="n">majpri</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">minpri</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">can_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opcode</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a CBUS/VLCB header</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>byte1</code>
            </td>
            <td>
                  <code><span title="byte">byte</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Most significant byte</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>byte2</code>
            </td>
            <td>
                  <code><span title="byte">byte</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Least significant byte</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A hex representation of the number</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
            <span class="n">majpri</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mb">0b10</span><span class="p">,</span> 
            <span class="n">minpri</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">can_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
            <span class="n">opcode</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a CBUS/VLCB header</span>

<span class="sd">    Args:</span>
<span class="sd">        byte1 (byte): Most significant byte</span>
<span class="sd">        byte2 (byte): Least significant byte</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A hex representation of the number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">can_id</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">can_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_id</span>

    <span class="k">if</span> <span class="n">minpri</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">opcode</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">minpri</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_priority</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span>

    <span class="c1"># If opcode not updated then use default low priority</span>
    <span class="c1"># Lower number is higher priority</span>
    <span class="k">if</span> <span class="n">minpri</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">minpri</span> <span class="o">=</span> <span class="mb">0b11</span>

    <span class="n">header_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">majpri</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">minpri</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">can_id</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">header_to_hex</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;000&quot;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">header_val</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[</span><span class="mi">2</span><span class="p">:])[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>
    <span class="n">header_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;:S</span><span class="si">{</span><span class="n">header_to_hex</span><span class="si">}</span><span class="s1">N&#39;</span>
    <span class="k">return</span> <span class="n">header_string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.parse_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_input</span><span class="p">(</span><span class="n">input_bytes</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Parse a raw CBUS packet as an input bytestring</p>
<p>Take a bytestring (or string) from the CBUS and extract the details</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_types</code>
            </td>
            <td>
                  <code><span title="bytestring">bytestring</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input raw bytestring (or string)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>VLCBFormat</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="pyvlcb.vlcbformat.VLCBFormat" href="#pyvlcb.VLCBFormat">VLCBFormat</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>parsed data in VLCBFormat</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If invalid data string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_bytes</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VLCBFormat</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a raw CBUS packet as an input bytestring</span>

<span class="sd">    Take a bytestring (or string) from the CBUS and extract the details</span>

<span class="sd">    Args: </span>
<span class="sd">        input_types (bytestring): Input raw bytestring (or string)</span>

<span class="sd">    Returns:</span>
<span class="sd">        VLCBFormat: parsed data in VLCBFormat</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If invalid data string</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Also allow string (no need to decode)</span>
    <span class="k">if</span> <span class="nb">isinstance</span> <span class="p">(</span><span class="n">input_bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">input_string</span> <span class="o">=</span> <span class="n">input_bytes</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">input_string</span> <span class="o">=</span> <span class="n">input_bytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_string</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">):</span>        <span class="c1"># packets are actually much longer</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;input_bytes &#39;</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s2">&#39; is too short.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">input_string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;:&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No start frame in &#39;</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">input_string</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;S&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Format not supported - only Standard frames allowed in </span><span class="si">{input_string}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Use try when converting to number in case of error</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">input_string</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">header_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid format, number expected </span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">header_val</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Header </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">header_val</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="p">(</span><span class="n">header_val</span> <span class="o">&amp;</span> <span class="mh">0xf000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Priority </span><span class="si">{</span><span class="n">priority</span><span class="si">:</span><span class="s2">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">can_id</span> <span class="o">=</span> <span class="p">(</span><span class="n">header_val</span> <span class="o">&amp;</span> <span class="mh">0xfe0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Can ID </span><span class="si">{</span><span class="n">can_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Next is N / RTR can be ignored</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;N / RTR </span><span class="si">{</span><span class="n">input_string</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Data is rest excluding ; </span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">input_string</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Creates a VLCB_format and returns that</span>
    <span class="k">return</span> <span class="n">VLCBFormat</span> <span class="p">(</span><span class="n">priority</span><span class="p">,</span> <span class="n">can_id</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.release_loco" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">release_loco</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create a release loco request</p>
<p>Uses KLOC (21)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>session_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Session number</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">release_loco</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a release loco request</span>

<span class="sd">    Uses KLOC (21)</span>

<span class="sd">    Args:</span>
<span class="sd">        session_id: Session number</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;21&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">21</span><span class="si">{</span><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span><span class="si">}</span><span class="s2">;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.share_loco" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">share_loco</span><span class="p">(</span><span class="n">loco_id</span><span class="p">,</span> <span class="n">long</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an share loco request</p>
<p>Takes the loco and other connectons to the loco can remain.
Uses GLOC (61)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>loco_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loco ID (long or short number)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>long</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Long loco ID (True) or short loco ID (False)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">share_loco</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loco_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an share loco request</span>

<span class="sd">    Takes the loco and other connectons to the loco can remain.</span>
<span class="sd">    Uses GLOC (61)</span>

<span class="sd">    Args:</span>
<span class="sd">        loco_id: Loco ID (long or short number)</span>
<span class="sd">        long: Long loco ID (True) or short loco ID (False)</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidLocoError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># GLOC 61 - flag = 1 for steal, flag = for share</span>
    <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">loco_id</span> <span class="o">&gt;=</span> <span class="mi">127</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidLocoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid short code </span><span class="si">{</span><span class="n">loco_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">loco_id</span> <span class="o">=</span> <span class="n">loco_id</span> <span class="o">|</span> <span class="mh">0xC000</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;61&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">61</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">loco_id</span><span class="p">)</span><span class="si">}</span><span class="s2">02;&quot;</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCB.steal_loco" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">steal_loco</span><span class="p">(</span><span class="n">loco_id</span><span class="p">,</span> <span class="n">long</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Create an steal loco request</p>
<p>Takes the loco and other connectons to the loco should be terminated.      <br />
Uses GLOC (60)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>loco_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loco ID (long or short number)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>long</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Long loco ID (True) or short loco ID (False)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A string for the request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">steal_loco</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loco_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">long</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an steal loco request</span>

<span class="sd">    Takes the loco and other connectons to the loco should be terminated.        </span>
<span class="sd">    Uses GLOC (60)</span>

<span class="sd">    Args:</span>
<span class="sd">        loco_id: Loco ID (long or short number)</span>
<span class="sd">        long: Long loco ID (True) or short loco ID (False)</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A string for the request</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidLocoError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># GLOC 61 - flag = 1 for steal, flag = for share</span>
    <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">loco_id</span> <span class="o">&gt;=</span> <span class="mi">127</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidLocoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid short code </span><span class="si">{</span><span class="n">loco_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">long</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">loco_id</span> <span class="o">=</span> <span class="n">loco_id</span> <span class="o">|</span> <span class="mh">0xC000</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">make_header</span><span class="p">(</span><span class="n">opcode</span><span class="o">=</span><span class="s1">&#39;61&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">61</span><span class="si">{</span><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">loco_id</span><span class="p">)</span><span class="si">}</span><span class="s2">01;&quot;</span>   
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<a id="pyvlcb.CanUSB4"></a>
    <div class="doc doc-contents first">



        <p>Handle USB serial communication to CANUSB4</p>
<p>Uses pyserial to communicate over USB.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pyvlcb.CanUSB4.port">port</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The usb port eg. /dev/ttyACM0 (RPi)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/pyvlcb/canusb.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CanUSB4</span> <span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle USB serial communication to CANUSB4</span>

<span class="sd">    Uses pyserial to communicate over USB.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        port: The usb port eg. /dev/ttyACM0 (RPi)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                  <span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                  <span class="n">baud</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">115200</span><span class="p">,</span> 
                  <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
                  <span class="n">exclusive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits CanUSB4 with a USB port</span>

<span class="sd">        Args:</span>
<span class="sd">            port: USB port eg. /dev/ttyACM0 (RPi)</span>
<span class="sd">            baud: Baud rate in bytes</span>
<span class="sd">            timeout: How long to wait for a serial timeout (seconds)</span>

<span class="sd">        Raises:</span>
<span class="sd">            DeviceConnectionError: If the port cannot be opened or is already in use.</span>
<span class="sd">            InvalidConfigurationError: If the port name is empty or invalid.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baud</span> <span class="o">=</span> <span class="n">baud</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_retry</span> <span class="o">=</span> <span class="mi">30</span>    <span class="c1"># How many times to attempt on get_data must be at least as long as frame</span>
        <span class="c1"># Timeout for a request could be max_rety x timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exclusive</span> <span class="o">=</span> <span class="n">exclusive</span>	<span class="c1"># Exclusive determines if check for exclusive use of the USB port</span>
        <span class="c1"># If this is set to false then if another application is already using the port then the application</span>
        <span class="c1"># will run, but appear to hang if there is no response because another thread has already</span>
        <span class="c1"># taken the incoming data</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">port</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidConfigurationError</span><span class="p">(</span><span class="s2">&quot;Port name cannot be empty&quot;</span><span class="p">)</span>

        <span class="c1"># buffer to hold partial string - allows us to continue if read ends partway through a packet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="c1"># Track if we are in a valid string (ie. ignore any data outside of : ; blocks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_start</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>


    <span class="c1"># Optional arguments override existing</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">baud</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">exclusive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits CanUSB4 with a USB port</span>

<span class="sd">        Args:</span>
<span class="sd">            port: USB port eg. /dev/ttyACM0 (RPi)</span>
<span class="sd">            baud: Baud rate in bytes</span>
<span class="sd">            timeout: How long to wait for a serial timeout (seconds)</span>

<span class="sd">        Raises:</span>
<span class="sd">            DeviceConnectionError: If the port cannot be opened or is already in use.</span>
<span class="sd">            InvalidConfigurationError: If the port name is empty or invalid.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">port</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidConfigurationError</span><span class="p">(</span><span class="s2">&quot;Port name cannot be empty&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">baud</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">baud</span> <span class="o">=</span> <span class="n">baud</span>
        <span class="k">if</span> <span class="n">timeout</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="k">if</span> <span class="n">exclusive</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exclusive</span> <span class="o">=</span> <span class="n">exclusive</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">baud</span><span class="p">,</span>
                <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
                <span class="n">exclusive</span> <span class="o">=</span> <span class="n">exclusive</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DeviceConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not open port </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Connected to serial port&quot;</span><span class="p">)</span>


    <span class="c1"># Data can either be string or bytestring</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">send_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send data to serial</span>

<span class="sd">        Args:</span>
<span class="sd">            data: Data to send, normally from a VLCB method</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidConfigurationError: If string contains invalid characters</span>
<span class="sd">            TypeError: If data passed is not a string or a bytestring</span>
<span class="sd">            DeviceConnectionError: Error sending data - possible connection lost</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sending </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Convert string to bytes</span>
                <span class="n">payload</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span> <span class="c1"># using ascii which is more restrictive than default &quot;utf-8&quot;</span>
            <span class="k">except</span> <span class="ne">UnicodeEncodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InvalidConfigurationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;String contains invalid characters: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="c1"># It&#39;s already bytes, just use it</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># User sent an int, list, or something else weird</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected str or bytes, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Send payload which is now bytes</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DeviceConnectionError</span><span class="p">(</span><span class="s2">&quot;Connection lost during write&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read data from CanUSB4</span>

<span class="sd">        Returns:</span>
<span class="sd">            List: List of strings for all data read</span>

<span class="sd">        Raises:</span>
<span class="sd">            DeviceConnectionError: Error receiving data - possible connection list</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">num_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">.</span><span class="n">in_waiting</span>
        <span class="c1"># As each data string is read then it is stored into this list</span>
        <span class="c1"># Which allows all new packets to be returned</span>
        <span class="n">received_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">num_bytes</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">in_chars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">num_bytes</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DeviceConnectionError</span><span class="p">(</span><span class="s2">&quot;Connection lost during read&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
            <span class="c1"># Unable to communicate with USB</span>
            <span class="c1"># Any other error</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">DeviceConnectionError</span><span class="p">(</span><span class="s2">&quot;Unable to read other error&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>


            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_chars</span><span class="p">)):</span>
                <span class="n">this_char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">in_chars</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1"># End of packet</span>
                <span class="k">if</span> <span class="n">this_char</span> <span class="o">==</span> <span class="s1">&#39;;&#39;</span><span class="p">:</span>
                    <span class="c1"># Check we have some data if not then ignore</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="c1"># Add the terminating char</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">+=</span> <span class="n">this_char</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">received_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span><span class="p">)</span>
                    <span class="c1"># delete the data</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="c1"># no longer inside a data packet</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_start</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="c1"># Start of packet (resets string even if previous data)</span>
                <span class="k">elif</span> <span class="n">this_char</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data_start</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span>
                <span class="c1"># Only add character if we are inside a data block</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_start</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">+=</span> <span class="n">this_char</span>
                <span class="c1"># If not then we are not in data block</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
        <span class="k">return</span> <span class="n">received_data</span>    
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="pyvlcb.CanUSB4.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="n">baud</span><span class="o">=</span><span class="mi">115200</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inits CanUSB4 with a USB port</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>USB port eg. /dev/ttyACM0 (RPi)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>baud</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Baud rate in bytes</p>
              </div>
            </td>
            <td>
                  <code>115200</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How long to wait for a serial timeout (seconds)</p>
              </div>
            </td>
            <td>
                  <code>0.01</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyvlcb.exceptions.DeviceConnectionError">DeviceConnectionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the port cannot be opened or is already in use.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyvlcb.exceptions.InvalidConfigurationError">InvalidConfigurationError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the port name is empty or invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/canusb.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
              <span class="n">port</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
              <span class="n">baud</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">115200</span><span class="p">,</span> 
              <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
              <span class="n">exclusive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits CanUSB4 with a USB port</span>

<span class="sd">    Args:</span>
<span class="sd">        port: USB port eg. /dev/ttyACM0 (RPi)</span>
<span class="sd">        baud: Baud rate in bytes</span>
<span class="sd">        timeout: How long to wait for a serial timeout (seconds)</span>

<span class="sd">    Raises:</span>
<span class="sd">        DeviceConnectionError: If the port cannot be opened or is already in use.</span>
<span class="sd">        InvalidConfigurationError: If the port name is empty or invalid.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">baud</span> <span class="o">=</span> <span class="n">baud</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_retry</span> <span class="o">=</span> <span class="mi">30</span>    <span class="c1"># How many times to attempt on get_data must be at least as long as frame</span>
    <span class="c1"># Timeout for a request could be max_rety x timeout</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exclusive</span> <span class="o">=</span> <span class="n">exclusive</span>	<span class="c1"># Exclusive determines if check for exclusive use of the USB port</span>
    <span class="c1"># If this is set to false then if another application is already using the port then the application</span>
    <span class="c1"># will run, but appear to hang if there is no response because another thread has already</span>
    <span class="c1"># taken the incoming data</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">port</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidConfigurationError</span><span class="p">(</span><span class="s2">&quot;Port name cannot be empty&quot;</span><span class="p">)</span>

    <span class="c1"># buffer to hold partial string - allows us to continue if read ends partway through a packet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="c1"># Track if we are in a valid string (ie. ignore any data outside of : ; blocks</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_start</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.CanUSB4.connect" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">connect</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">baud</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exclusive</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inits CanUSB4 with a USB port</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>port</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>USB port eg. /dev/ttyACM0 (RPi)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>baud</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Baud rate in bytes</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How long to wait for a serial timeout (seconds)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyvlcb.exceptions.DeviceConnectionError">DeviceConnectionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the port cannot be opened or is already in use.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyvlcb.exceptions.InvalidConfigurationError">InvalidConfigurationError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the port name is empty or invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/canusb.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">baud</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">exclusive</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits CanUSB4 with a USB port</span>

<span class="sd">    Args:</span>
<span class="sd">        port: USB port eg. /dev/ttyACM0 (RPi)</span>
<span class="sd">        baud: Baud rate in bytes</span>
<span class="sd">        timeout: How long to wait for a serial timeout (seconds)</span>

<span class="sd">    Raises:</span>
<span class="sd">        DeviceConnectionError: If the port cannot be opened or is already in use.</span>
<span class="sd">        InvalidConfigurationError: If the port name is empty or invalid.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">port</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidConfigurationError</span><span class="p">(</span><span class="s2">&quot;Port name cannot be empty&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">baud</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baud</span> <span class="o">=</span> <span class="n">baud</span>
    <span class="k">if</span> <span class="n">timeout</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
    <span class="k">if</span> <span class="n">exclusive</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exclusive</span> <span class="o">=</span> <span class="n">exclusive</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">baud</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span>
            <span class="n">exclusive</span> <span class="o">=</span> <span class="n">exclusive</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DeviceConnectionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not open port </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Connected to serial port&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.CanUSB4.read_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_data</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Read data from CanUSB4</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>List</code></td>            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of strings for all data read</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyvlcb.exceptions.DeviceConnectionError">DeviceConnectionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Error receiving data - possible connection list</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/canusb.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read data from CanUSB4</span>

<span class="sd">    Returns:</span>
<span class="sd">        List: List of strings for all data read</span>

<span class="sd">    Raises:</span>
<span class="sd">        DeviceConnectionError: Error receiving data - possible connection list</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">num_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">.</span><span class="n">in_waiting</span>
    <span class="c1"># As each data string is read then it is stored into this list</span>
    <span class="c1"># Which allows all new packets to be returned</span>
    <span class="n">received_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">num_bytes</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">in_chars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">num_bytes</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DeviceConnectionError</span><span class="p">(</span><span class="s2">&quot;Connection lost during read&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="c1"># Unable to communicate with USB</span>
        <span class="c1"># Any other error</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DeviceConnectionError</span><span class="p">(</span><span class="s2">&quot;Unable to read other error&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>


        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">in_chars</span><span class="p">)):</span>
            <span class="n">this_char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">in_chars</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="c1"># End of packet</span>
            <span class="k">if</span> <span class="n">this_char</span> <span class="o">==</span> <span class="s1">&#39;;&#39;</span><span class="p">:</span>
                <span class="c1"># Check we have some data if not then ignore</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># Add the terminating char</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">+=</span> <span class="n">this_char</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">received_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span><span class="p">)</span>
                <span class="c1"># delete the data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="c1"># no longer inside a data packet</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_start</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># Start of packet (resets string even if previous data)</span>
            <span class="k">elif</span> <span class="n">this_char</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data_start</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span>
            <span class="c1"># Only add character if we are inside a data block</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_start</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_buffer</span> <span class="o">+=</span> <span class="n">this_char</span>
            <span class="c1"># If not then we are not in data block</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>
    <span class="k">return</span> <span class="n">received_data</span>    
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.CanUSB4.send_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">send_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Send data to serial</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="bytes">bytes</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data to send, normally from a VLCB method</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyvlcb.exceptions.InvalidConfigurationError">InvalidConfigurationError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If string contains invalid characters</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If data passed is not a string or a bytestring</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pyvlcb.exceptions.DeviceConnectionError">DeviceConnectionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Error sending data - possible connection lost</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/canusb.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">send_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send data to serial</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Data to send, normally from a VLCB method</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidConfigurationError: If string contains invalid characters</span>
<span class="sd">        TypeError: If data passed is not a string or a bytestring</span>
<span class="sd">        DeviceConnectionError: Error sending data - possible connection lost</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sending </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Convert string to bytes</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span> <span class="c1"># using ascii which is more restrictive than default &quot;utf-8&quot;</span>
        <span class="k">except</span> <span class="ne">UnicodeEncodeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidConfigurationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;String contains invalid characters: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="c1"># It&#39;s already bytes, just use it</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># User sent an int, list, or something else weird</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected str or bytes, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Send payload which is now bytes</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">serial</span><span class="o">.</span><span class="n">SerialException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DeviceConnectionError</span><span class="p">(</span><span class="s2">&quot;Connection lost during write&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<a id="pyvlcb.VLCBFormat"></a>
    <div class="doc doc-contents first">



        <p>Handles a single VLCB packet</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pyvlcb.VLCBFormat.priority">priority</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CAN priority</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyvlcb.VLCBFormat.can_id">can_id</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CAN ID</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyvlcb.VLCBFormat.data">data</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Remaining data as a hex str</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">VLCBFormat</span> <span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Handles a single VLCB packet</span>

<span class="sd">    Attributes:</span>
<span class="sd">        priority: CAN priority</span>
<span class="sd">        can_id: CAN ID</span>
<span class="sd">        data: Remaining data as a hex str</span>

<span class="sd">    &quot;&quot;&quot;</span> 

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">can_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inits VLCBformat</span>

<span class="sd">        Args:</span>
<span class="sd">            priority: CAN priority</span>
<span class="sd">            can_id: CAN ID</span>
<span class="sd">            data: Remaining data as a hex string</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="n">priority</span> <span class="c1"># Priority is actually high and low priority (2bit high / 2bit low) but just treated as single value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">can_id</span> <span class="o">=</span> <span class="n">can_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="c1"># Data is left as hex string</span>

    <span class="c1"># Lookup OpCode</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">opcode</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># -&gt; Dict[str,str]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the opcode associated with the data string</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary of the opcode data</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If opcode not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">str_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">str_value</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">str_value</span><span class="p">][</span><span class="s1">&#39;opc&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="n">str_value</span><span class="si">}</span><span class="s2"> is not defined.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpcodeData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the opcode associated with the data string as a dict</span>

<span class="sd">        Returns:</span>
<span class="sd">            OpcodeData: Dict from the VLCBOpcode</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If opcode not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpcodeData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the opcode associated with the data string</span>

<span class="sd">        Returns:</span>
<span class="sd">            OpcodeData: Dict from the VLCBOpcode</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If opcode not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_loco_id</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts AddrHigh and AddrLow into a loco_id</span>

<span class="sd">        Only valid with certain VLCBFormat packets associated with Locos.</span>
<span class="sd">        If packet is does not contain the AddrHigh &amp; AddrLow values (which</span>
<span class="sd">        may be formatted differently) then raises a InvalidLocoError</span>

<span class="sd">        Returns:</span>
<span class="sd">            loco_id: Loco number</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidLocoError: If AddrHigh / AddrLow are not in the packet</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">loco_id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PLOC&quot;</span><span class="p">:</span>
            <span class="c1"># Get data</span>
            <span class="n">data_dict</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">loco_id</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;AddrHigh_AddrLow&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3FFF</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ERR&quot;</span><span class="p">:</span>
            <span class="c1"># also check it&#39;s one of the Error codes associated with allocate loco etc.</span>
            <span class="c1"># 1 = loco stack full 2 = loco taken, 7 = invalid request</span>
            <span class="c1"># The following are not supported as data bytes contain session / consist ID and not loco_id</span>
            <span class="c1"># 3 = no session, 4 consist empty, 5 loco not found, 6 can bus error</span>
            <span class="n">data_dict</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;ErrCode&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
                <span class="n">loco_id</span> <span class="o">=</span> <span class="n">bytes_to_addr</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Byte1&#39;</span><span class="p">],</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Byte2&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0x3FFF</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InvalidLocoError</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error code </span><span class="si">{</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;ErrCode&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> does not contain a loco_id&quot;</span><span class="p">)</span>

        <span class="c1"># If loco_id not updated then raise error</span>
        <span class="k">if</span> <span class="n">loco_id</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">loco_id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidLocoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span><span class="si">}</span><span class="s2"> does not contain a loco_id&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_function_list</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Where packet contains Fn1, Fn2, Fn3 (eg. PLOC)</span>
<span class="sd">        returns </span>

<span class="sd">        Only valid with certain VLCBFormat packets associated with Locos.</span>
<span class="sd">        If packet is does not contain the 3 byte values (which</span>
<span class="sd">        may be formatted differently) then raises a InvalidFunctionError</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of function values as 0 or 1 for each function as off and on</span>

<span class="sd">        Raises:</span>
<span class="sd">            InvalidFunctionError: If Function Bytes are not in the packet</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PLOC&quot;</span><span class="p">:</span>
            <span class="c1"># Get data</span>
            <span class="n">data_dict</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bytes_to_functions</span> <span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Fn1&#39;</span><span class="p">],</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Fn2&#39;</span><span class="p">],</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Fn3&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidLocoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span><span class="si">}</span><span class="s2"> does not contain a loco_id&quot;</span><span class="p">)</span>




    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">priority</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">can_id</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s1">) : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s1"> / </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">format_data</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBFormat.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">priority</span><span class="p">,</span> <span class="n">can_id</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Inits VLCBformat</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>priority</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CAN priority</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>can_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CAN ID</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Remaining data as a hex string</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">can_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inits VLCBformat</span>

<span class="sd">    Args:</span>
<span class="sd">        priority: CAN priority</span>
<span class="sd">        can_id: CAN ID</span>
<span class="sd">        data: Remaining data as a hex string</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="n">priority</span> <span class="c1"># Priority is actually high and low priority (2bit high / 2bit low) but just treated as single value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">can_id</span> <span class="o">=</span> <span class="n">can_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="c1"># Data is left as hex string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBFormat.format_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">format_data</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns the opcode associated with the data string</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>OpcodeData</code></td>            <td>
                  <code><span title="pyvlcb.vlcbformat.OpcodeData">OpcodeData</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict from the VLCBOpcode</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If opcode not found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">format_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpcodeData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the opcode associated with the data string</span>

<span class="sd">    Returns:</span>
<span class="sd">        OpcodeData: Dict from the VLCBOpcode</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If opcode not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBFormat.get_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_data</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns the opcode associated with the data string as a dict</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>OpcodeData</code></td>            <td>
                  <code><span title="pyvlcb.vlcbformat.OpcodeData">OpcodeData</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict from the VLCBOpcode</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If opcode not found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_data</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpcodeData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the opcode associated with the data string as a dict</span>

<span class="sd">    Returns:</span>
<span class="sd">        OpcodeData: Dict from the VLCBOpcode</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If opcode not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBFormat.get_function_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_function_list</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Where packet contains Fn1, Fn2, Fn3 (eg. PLOC)
returns </p>
<p>Only valid with certain VLCBFormat packets associated with Locos.
If packet is does not contain the 3 byte values (which
may be formatted differently) then raises a InvalidFunctionError</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of function values as 0 or 1 for each function as off and on</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="InvalidFunctionError">InvalidFunctionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If Function Bytes are not in the packet</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_function_list</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Where packet contains Fn1, Fn2, Fn3 (eg. PLOC)</span>
<span class="sd">    returns </span>

<span class="sd">    Only valid with certain VLCBFormat packets associated with Locos.</span>
<span class="sd">    If packet is does not contain the 3 byte values (which</span>
<span class="sd">    may be formatted differently) then raises a InvalidFunctionError</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of function values as 0 or 1 for each function as off and on</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidFunctionError: If Function Bytes are not in the packet</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PLOC&quot;</span><span class="p">:</span>
        <span class="c1"># Get data</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bytes_to_functions</span> <span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Fn1&#39;</span><span class="p">],</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Fn2&#39;</span><span class="p">],</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Fn3&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidLocoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span><span class="si">}</span><span class="s2"> does not contain a loco_id&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBFormat.get_loco_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_loco_id</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Converts AddrHigh and AddrLow into a loco_id</p>
<p>Only valid with certain VLCBFormat packets associated with Locos.
If packet is does not contain the AddrHigh &amp; AddrLow values (which
may be formatted differently) then raises a InvalidLocoError</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>loco_id</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loco number</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="InvalidLocoError">InvalidLocoError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If AddrHigh / AddrLow are not in the packet</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_loco_id</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts AddrHigh and AddrLow into a loco_id</span>

<span class="sd">    Only valid with certain VLCBFormat packets associated with Locos.</span>
<span class="sd">    If packet is does not contain the AddrHigh &amp; AddrLow values (which</span>
<span class="sd">    may be formatted differently) then raises a InvalidLocoError</span>

<span class="sd">    Returns:</span>
<span class="sd">        loco_id: Loco number</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidLocoError: If AddrHigh / AddrLow are not in the packet</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">loco_id</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PLOC&quot;</span><span class="p">:</span>
        <span class="c1"># Get data</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">loco_id</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;AddrHigh_AddrLow&#39;</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3FFF</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;ERR&quot;</span><span class="p">:</span>
        <span class="c1"># also check it&#39;s one of the Error codes associated with allocate loco etc.</span>
        <span class="c1"># 1 = loco stack full 2 = loco taken, 7 = invalid request</span>
        <span class="c1"># The following are not supported as data bytes contain session / consist ID and not loco_id</span>
        <span class="c1"># 3 = no session, 4 consist empty, 5 loco not found, 6 can bus error</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">parse_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;ErrCode&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
            <span class="n">loco_id</span> <span class="o">=</span> <span class="n">bytes_to_addr</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Byte1&#39;</span><span class="p">],</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Byte2&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0x3FFF</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidLocoError</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error code </span><span class="si">{</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;ErrCode&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> does not contain a loco_id&quot;</span><span class="p">)</span>

    <span class="c1"># If loco_id not updated then raise error</span>
    <span class="k">if</span> <span class="n">loco_id</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">loco_id</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidLocoError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">opcode</span><span class="p">()</span><span class="si">}</span><span class="s2"> does not contain a loco_id&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBFormat.opcode" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">opcode</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Returns the opcode associated with the data string</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of the opcode data</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If opcode not found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">opcode</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># -&gt; Dict[str,str]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the opcode associated with the data string</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary of the opcode data</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If opcode not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">str_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">str_value</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">str_value</span><span class="p">][</span><span class="s1">&#39;opc&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="n">str_value</span><span class="si">}</span><span class="s2"> is not defined.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<a id="pyvlcb.VLCBOpcode"></a>
    <div class="doc doc-contents first">



        <p>List of opcodes and other related data</p>
<p>Includes format information and user friendly strings</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pyvlcb.VLCBOpcode.opcodes">opcodes</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of opcodes indexed by opcode number as a hex string</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyvlcb.VLCBOpcode.field_formats">field_formats</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of data type and number of characters for each field</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pyvlcb.VLCBOpcode.accessory_codes">accessory_codes</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of accessory on and off codes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">VLCBOpcode</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of opcodes and other related data</span>

<span class="sd">    Includes format information and user friendly strings</span>

<span class="sd">    Attributes:</span>
<span class="sd">        opcodes: Dict of opcodes indexed by opcode number as a hex string</span>
<span class="sd">        field_formats: Dict of data type and number of characters for each field</span>
<span class="sd">        accessory_codes: Dict of accessory on and off codes</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Dict from opcode to dict of opcode information</span>
    <span class="n">opcodes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;00&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACK&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;General Acknowledgement&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Positive response to query/request performed for report of availability online&#39;</span><span class="p">},</span>
        <span class="s1">&#39;01&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NAK&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;General No Ack&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Negative response to query/request denied&#39;</span><span class="p">},</span>
        <span class="s1">&#39;02&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;HLT&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Bus Halt&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Commonly broadcasted to all nodes to indicate CBUS is not available and no further packets should be sent until a BON or ARST is received&#39;</span><span class="p">},</span>
        <span class="s1">&#39;03&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;BON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Bus On&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Commonly broadcasted to all nodes to indicate CBUS is available following a HLT.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;04&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;TOF&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Track Off&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Commonly broadcasted to all nodes by a command station to indicate track power is off and no further command packets should be sent, except inquiries..&#39;</span><span class="p">},</span>
        <span class="s1">&#39;05&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;TON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Track On&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Commonly broadcasted to all nodes by a command station to indicate track power is on.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;06&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ERSTOP&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Emergency Stop&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Commonly broadcase to all nodes by a command station to indicate all engines have been emergency stopped.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;07&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARST&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;System Reset&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Commonly broadcasted to all nodes to indicate a full system reset.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;08&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RTOF&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request Track Off&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent to request change of track power to off.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;09&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RTON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request Track On&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent to request change of track power to on.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;0A&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RESTP&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request Emergency Stop All&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent to request an emergency stop to all trains . Does not affect accessory control.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;0C&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request Command Station Status&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent to query the status of the command station. See description of (STAT) for the response from the command station.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;0D&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;QNN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Query node number&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a node to elicit a PNN reply from each node on the bus that has a node number. See OpCode 0xB6&#39;</span><span class="p">},</span>
        <span class="s1">&#39;10&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RQNP&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request node parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent to a node while in ?setup?mode to read its parameter set. Used when initially configuring a node.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;11&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RQMN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request module name&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a node to request the name of the type of module that is in setup mode. The module in setup mode will reply with opcode NAME. See OpCode 0xE2&#39;</span><span class="p">},</span>
        <span class="c1"># Session is the engine session number as HEX byte.</span>
        <span class="s1">&#39;21&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;KLOC&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Release Engine&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a CAB to the Command Station. The engine with that Session number is removed from the active engine list.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;22&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;QLOC&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Query Engine&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;The command station responds with PLOC if the session is assigned. Otherwise responds with ERR: engine not found.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;23&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DKEEP&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Session keep alive&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;The cab sends a keep alive at regular intervals for the active session. The interval between keep alive messages must be less than the session timeout implemented by the command station.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;30&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DBG1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Debug with one data byte&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is a freeform status byte for debugging during CBUS module development. Not used during normal operation&#39;</span><span class="p">},</span>
        <span class="s1">&#39;3F&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EXTC&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Extended op-code with no additional bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;ExtOpc&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used if the basic set of 32 OPCs is not enough. Allows an additional 256 OPCs&#39;</span><span class="p">},</span>
        <span class="c1">#AddrHigh_AddrLow = Address of the decoder - 7 bit addresses have (AddrH=0). 14 bit addresses have bits 6,7 of AddrH set to 1.</span>
        <span class="s1">&#39;40&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RLOC&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request engine session&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;AddrHigh_AddrLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;The command station responds with (PLOC) if engine is free and is being assigned. Otherwise responds with (ERR): engine in use or (ERR:) stack full. This command is typically sent by a cab to the command station following a change of the controlled decoder address. RLOC is exactly equivalent to GLOC with all flag bits set to zero, but command stations must continue to support RLOC for backwards compatibility.&#39;</span><span class="p">},</span>
        <span class="c1"># Consist = Consist address</span>
        <span class="c1"># Index = Engine index of the consist</span>
        <span class="s1">&#39;41&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;QCON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Query Consist&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Consist,Index&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Allows enumeration of a consist. Command station responds with PLOC if an engine exists at the specified index, otherwise responds with ERR: no more engines&#39;</span><span class="p">},</span>
        <span class="c1"># NNHigh = high byte of the node number</span>
        <span class="c1"># NNLow = low byte of the node number</span>
        <span class="s1">&#39;42&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;SNN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set Node Number&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to assign a node number to a requesting node in response to a RQNN message. The target node must be in ?setup? mode.&#39;</span><span class="p">},</span>
        <span class="c1"># AllocCode = specific allocation code (1 byte)</span>
        <span class="s1">&#39;43&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ALOC&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Allocate loco to activity&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,AllocCode&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">},</span>
        <span class="s1">&#39;44&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;STMOD&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set CAB session mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,Mode&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;MMMMMMMM = mode bits: 0 ? 1: speed mode; 00 ? 128 speed steps; 01 ? 14 speed steps; 10 ? 28 speed steps with interleave steps; 11 ? 28 speed steps; 2: service mode; 3: sound control mode&#39;</span><span class="p">},</span>
        <span class="c1"># Consist is consist address (8 bits)</span>
        <span class="s1">&#39;45&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;PCON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Consist Engine&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,Consist&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Adds a decoder to a consist. Dat2 has bit 7 set if consist direction is reversed.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;46&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;KCON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Remove Engine from consist&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,Consist&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Removes a loco from a consist.&#39;</span><span class="p">},</span>
        <span class="c1"># SpeedDir = Speed/dir value. Most significant bit is direction and 7 bits are unsigned speed value. </span>
        <span class="s1">&#39;47&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DSPD&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set Engine Speed/Dir&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,SpeedDir&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;the unsigned speed value. Sent by a CAB or equivalent to request an engine speed/dir change.&#39;</span><span class="p">},</span>
        <span class="c1"># SpeedFlag - Is speed flags</span>
        <span class="s1">&#39;48&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DFLG&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set Engine Flags&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,SpeedFlag&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Bits 0-1: Speed Mode 00 ? 128 speed steps; 01 ? 14 speed steps; 10 ? 28 speed steps with interleave steps; 11 ? 28 speed steps Bit 2: Lights On/OFF; Bit 3: Engine relative direction; Bits 4-5: Engine state (active =0 , consisted =1, consist master=2, inactive=3) Bits 6-7: Reserved.; Sent by a cab to notify the command station of a change in engine flags.&#39;</span><span class="p">},</span>
        <span class="c1"># Fnum = Function number, 0 to 27</span>
        <span class="s1">&#39;49&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DFNON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set Engine function on&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,Fnum&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a cab to turn on a specific loco function. This provides an alternative method to DFUN for controlling loco functions. A command station must implement both methods.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;4C&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;SSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Service mode status&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,Status&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Status returned by command station/programmer at end of programming operation that does not return data.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;50&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RQNN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request node number&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a node that is in setup/configuration mode and requests assignment of a node number (NN). The node allocating node numbers responds with (SNN) which contains the newly assigned node number. &lt;NN hi&gt; and &lt;NN lo&gt; are the existing node number, if the node has one. If it does not yet have a node number, these bytes should be set to zero.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;51&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NNREL&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Node number release&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by node when taken out of service. e.g. when reverting to SLiM mode.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;52&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NNACK&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Node number acknowledge&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a node to verify its presence and confirm its node id. This message is sent to acknowledge an SNN.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;53&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NNLRN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set node into learn mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to put a specific node into learn mode. Deprecated - replaced by MODE&#39;</span><span class="p">},</span>
        <span class="s1">&#39;54&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NNULN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Release node from learn mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to take node out of learn mode and revert to normal operation.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;55&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NNCLR&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Clear all events from a node&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to clear all events from a specific node. Must be in learn mode first to safeguard against accidental erasure of all events.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;56&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NNEVN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Read number of events available in a node&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to read the number of available event slots in a node.Response is EVLNF (0x70)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;57&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NERD&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Read back all stored events in a node&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to read all the stored events in a node. Response is 0xF2.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;58&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RQEVN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request to read number of stored events&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to read the number of stored events in a node. Response is 0x74( NUMEV).&#39;</span><span class="p">},</span>
        <span class="s1">&#39;59&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;WRACK&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Write acknowledge&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a node to indicate the completion of a write to memory operation. All nodes must issue WRACK when a write operation to node variables, events or event variables has completed. This allows for teaching nodes where the processing time may be slow. Deprecated replaced by GRSP&#39;</span><span class="p">},</span>
        <span class="s1">&#39;5A&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RQDAT&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request node data event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by one node to read the data event from another node.(eg: RFID data). Response is 0xF7 (ARDAT).&#39;</span><span class="p">},</span>
        <span class="c1"># DN = Device number</span>
        <span class="s1">&#39;5B&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RQDDS&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request device data - short mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;DNHigh_DNLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;To request a data set from a device using the short event method. where DN is the device number. Response is 0xFB (DDRS)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;5C&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;BOOTM&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Put node into bootload mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;For SliM nodes with no NN then the NN of the command must be zero. For SLiM nodes with an NN, and all FLiM nodes the command must contain the NN of the target node. Sent by a configuration tool to prepare for loading a new program. Deprecated replaced by MODE&#39;</span><span class="p">},</span>
        <span class="s1">&#39;5D&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ENUM&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Force a self enumeration cyble for use with CAN&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;For nodes in FLiM using CAN as transport. This OPC will force a self-enumeration cycle for the specified node. A new CAN_ID will be allocated if needed. Following the ENUM sequence, the node should issue a NNACK to confirm completion and verify the new CAN_ID. If no CAN_ID values are available, an error message 7 will be issued instead. Deprecated replaced with automatic self enumeration.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;5F&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EXTC1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Extended op-code with 1 additional byte&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;ExtOpc,Byte1&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used if the basic set of 32 OPCs is not enough. Allows an additional 256 OPCs&#39;</span><span class="p">},</span>
        <span class="c1"># 3rd data section</span>
        <span class="s1">&#39;60&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DFUN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set Engine functions&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,Fn1,Fn2&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat2&gt; (Fn1) is the function range. 1 is F0(FL) to F4; 2 is F5 to F8; 3 is F9 to F12; 4 is F13 to F20; 5 is F21 to F28; &lt;Dat3&gt; (Fn2) is the NMRA DCC format function byte for that range in corresponding bits. Sent by a CAB or equivalent to request an engine Fn state change.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;61&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;GLOC&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Get engine session&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;AddrHigh_AddrLow,Flags&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; and &lt;Dat2&gt; are [AddrH] and [AddrL] of the decoder, respectively.; 7 bit addresses have (AddrH=0).; 14 bit addresses have bits 6,7 of AddrH set to 1.; &lt;Flags&gt; contains flag bits as follows:Bit 0: Set for &quot;Steal&quot; mode; Bit 1: Set for &quot;Share&quot; mode; Both bits set to 0 is exactly equivalent to an RLOC request; Both bits set to 1 is invalid, because the 2 modes are mutually exclusive; The command station responds with (PLOC) if the request is successful. Otherwise responds with (ERR): engine in use. (ERR:) stack full or (ERR) no session. The latter indicates that there is no current session to steal/share depending on the flag bits set in the request. GLOC with all flag bits set to zero is exactly equivalent to RLOC, but command stations must continue to support RLOC for backwards compatibility.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;63&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ERR&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Command station error report&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Byte1,Byte2,ErrCode&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent in response to an error situation by a command station.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;6F&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;CMDERR&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Error messages from nodes during configuration&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,Error&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by node if there is an error when a configuration command is sent. Deprecated replaced by GRSP.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;70&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EVNLF&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Event space left reply from node&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EVSPC&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;EVSPC is a one byte value giving the number of available events left in that node.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;71&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NVRD&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request read of a node variable&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,NVIndex&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;NV# is the index for the node variable value requested. Response is NVANS. VLCB also returns GRSP and support for NV#0.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;72&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NENRD&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request read of stored events by event index&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnIndex&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;EN# is the index for the stored event requested. Response is 0xF2 (ENRSP)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;73&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RQNPN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request read of a node parameter by index&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,ParaIndex&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Para# is the index for the parameter requested. Index 0 returns the number of available parameters, Response is 0x9B (PARAN). VLCB Para #0 returns a PARAN for each parameter&#39;</span><span class="p">},</span>
        <span class="s1">&#39;74&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NUMEV&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of events stored in node&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,NumEvents&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Response to request 0x58 (RQEVN)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;75&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;CANID&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set a CAN_ID in existing FLiM node&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,CAN_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used to force a specified CAN_ID into a node. Value range is from 1 to 0x63 (99 decimal) This OPC must be used with care as duplicate CAN_IDs are not allowed. Values outside the permitted range will produce an error 7 message and the CAN_ID will not change. Deprecated replaced with self-enumaration. VLCB includes GRSP responses.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;76&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;MODE&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request a change to a modules operating mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,ModeCmd&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Request to change the operational mode of the module. Mode cmds 0 = transition to setup mode, 1 = transition to normal mode, 16 = turn on FCU compat, 17 = turn off FCU compat. If supported then module returns GRSP. VLCB new features.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;78&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RQSD&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request service discover&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,ServiceIndex&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Request service data from a module if ServiceIndex is 0 then SD message sent, followed by ESD response for each services supported. VLCB new feature.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;7F&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EXTC2&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Extended op-code with 2 additional bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;ExtOpc,Byte1,Byte2&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used if the basic set of 32 OPCs is not enough. Allows an additional 256 OPCs&#39;</span><span class="p">},</span>
        <span class="c1"># 4 data byte packets</span>
        <span class="s1">&#39;80&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RDCC3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request 3-byte DCC Packet&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Rep,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1(REP)&gt; is number of repetitions in sending the packet. &lt;Dat2&gt;..&lt;Dat4&gt; 3 bytes of the DCC packet. Allows a CAB or equivalent to request a 3 byte DCC packet to be sent to the track. The packet is sent &lt;REP&gt; times and is not refreshed on a regular basis. Note: a 3 byte DCC packet is the minimum allowed.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;82&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;WCVO&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Write CV (byte) in OPS mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,CVHigh_CVLow,CVVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the session number of the loco to be written to; &lt;Dat2&gt; is the MSB # of the CV to be written (supports CVs 1 - 65536); &lt;Dat3&gt; is the LSB # of the CV to be written; &lt;Dat4&gt; is the byte value to be written; Sent to the command station to write a DCC CV byte in OPS mode to specific loco.(on the main)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;83&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;WCVB&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Write CV (bit) in OPS mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,CVHigh_CVLow,CVVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the session number of the loco to be written to; &lt;Dat2&gt; is the MSB # of the CV to be written (supports CVs 1 - 65536); &lt;Dat3&gt; is the LSB # of the CV to be written; &lt;Dat4&gt; is the value to be written; The format for Dat4 is that specified in RP 9.2.1 for OTM bit manipulation in a DCC packet.; This is ?111CDBBB? where C is here is always 1 as only ?writes? are possible OTM. (unless some loco ACK scheme like RailCom is used). D is the bit value, either 0 or 1 and BBB is the bit position in the CV byte. 000 to 111 for bits 0 to 7.; Sent to the command station to write a DCC CV in OPS mode to specific loco.(on the main)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;84&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;QCVS&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Read CV&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,CVHigh_CVLow,Mode&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;This command is used exclusively with service mode.; Sent by the cab to the command station in order to read a CV value. The command station shall respond with a PCVS message containing the value read, or SSTAT if the CV cannot be read.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;85&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;PCVS&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Report CV&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,CVHigh_CVLow,CVVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the session number of the cab; &lt;Dat2&gt; is the MSB # of the CV read (supports CVs 1 - 65536); &lt;Dat3&gt; is the LSB # of the CV read; &lt;Dat4&gt; is the read value; This command is used exclusively with service mode.; Sent by the command station to report a read CV.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;87&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RDGN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request dianostic data&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,ServiceIndex,DiagCode&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Request diagnostic data from a module. If DiagCode is 0 then all data returned. If ServiceIndex 0 then send DGN message for each service, otherwise send DGN for service specified&#39;</span><span class="p">},</span>
        <span class="s1">&#39;8E&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NVSETRD&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set an NV value with read back&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,NNIndex,NVVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sets an NV value and responds with the new value, response may not be the value requested. VLCB new feature.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;90&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory ON&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the high byte of the node number; &lt;Dat2&gt; is the low byte of the node number; &lt;Dat3&gt; is the high byte of the event number; &lt;Dat4&gt; is the low byte of the event number; Indicates an ?ON? event using the full event number of 4 bytes. (long event)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;91&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACOF&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory OFF&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the high byte of the node number; &lt;Dat2&gt; is the low byte of the node number; &lt;Dat3&gt; is the high byte of the event number; &lt;Dat4&gt; is the low byte of the event number; Indicates an ?OFF? event using the full event number of 4 bytes. (long event)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;92&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;AREQ&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Request Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the high byte of the node number (MS WORD of the full event #); &lt;Dat2&gt; is the low byte of the node number (MS WORD of the full event #); &lt;Dat3&gt; is the high byte of the event number; &lt;Dat4&gt; is the low byte of the event number; Indicates a ?request? event using the full event number of 4 bytes. (long event); A request event is used to elicit a status response from a producer when it is required to know the state of the producer without producing an ON or OFF event and to trigger an event from a combi node&#39;</span><span class="p">},</span>
        <span class="s1">&#39;93&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ?ON? response event. A response event is a reply to a status request (AREQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;94&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;AROF&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the high byte of the node number; &lt;Dat2&gt; is the low byte of the node number; &lt;Dat3&gt; is the high byte of the event number; &lt;Dat4&gt; is the low byte of the event number; Indicates an OFF response event. A response event is a reply to a status request; (AREQ) without producing an ON or OFF event&#39;</span><span class="p">},</span>
        <span class="s1">&#39;95&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EVULN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Unlearn an event in learn mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to remove an event from a node. VLCB also return GRSP.&#39;</span><span class="p">},</span>
        <span class="c1"># NVIndex is NV Index number</span>
        <span class="s1">&#39;96&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NVSET&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Set a node variable&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,NVIndex,NVVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to set a node variable. NV# is the NV index number. Deprecated replaced by NVSETRD. VLCB also return GRSP.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;97&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NVANS&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Response to a request for a node variable value&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,NVIndex,NVVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by node in response to request. (NVRD)&#39;</span><span class="p">},</span>
        <span class="c1"># Short events</span>
        <span class="c1"># DNHigh, DNLow = Lower two bytes define device number - considered same as a device address - full 4byte event is still sent</span>
        <span class="c1"># &lt;Dat1&gt; is the high byte of the node number; &lt;Dat2&gt; is the low byte of the node number; &lt;Dat3&gt; is the high byte of the Device Number; &lt;Dat4&gt; is the low byte of the Device Number</span>
        <span class="s1">&#39;98&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ASON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory short ON&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON event using the short event number of 2 LS bytes.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;99&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ASOF&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory short OFF&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an OFF event using the short event number of 2 LS bytes.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;9A&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ASRQ&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short Request Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates a request event using the short event number of 2 LS bytes. A request event is used to elicit a response from a producer device when it is required to know the state of the device without producing an ON or OFF event and to trigger an event from a combi node.&#39;</span><span class="p">},</span>
        <span class="c1"># ParaIndex = Index of parameter</span>
        <span class="c1"># ParaVal = Parameter value</span>
        <span class="s1">&#39;9B&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;PARAN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Response to request for individual node parameter&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,ParaIndex,ParaVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;NN is the node number of the sending node. Para# is the index of the parameter and Para val is the parameter value.&#39;</span><span class="p">},</span>
        <span class="c1"># EnIndex is event index</span>
        <span class="c1"># EvIndex is Event variable index</span>
        <span class="s1">&#39;9C&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;REVAL&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request for read of an event variable&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnIndex,EvIndex&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;This request differs from B2 (REQEV) as it doesnt need to be in learn mode but does; require the knowledge of the event index to which the EV request is directed.; EN# is the event index. EV# is the event variable index. Response is B5 (NEVAL)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;9D&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARSON&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory short response event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON response event. A response event is a reply to a status request (ASRQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;9E&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARSOF&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory short response event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;ndicates an OFF response event. A response event is a reply to a status request (ASRQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;9F&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EXTC3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Extended op-code with 3 additional bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;ExtOpc,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used if the basic set of 32 OPCs is not enough. Allows an additional 256 OPCs&#39;</span><span class="p">},</span>
        <span class="c1"># 5 data byte packets</span>
        <span class="c1"># Rep = repeat</span>
        <span class="s1">&#39;A0&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RDCC4&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request 4-byte DCC packet&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Rep,Byte1,Byte2,Byte3,Byte4&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1(REP)&gt; is number of repetitions in sending the packet.; &lt;Dat2&gt;..&lt;Dat5&gt; 4 bytes of the DCC packet.; Allows a CAB or equivalent to request a 4 byte DCC packet to be sent to the track. The; packet is sent &lt;REP&gt; times and is not refreshed on a regular basis.&#39;</span><span class="p">},</span>
        <span class="c1"># CVHigh MSB of CV (1-65536)</span>
        <span class="c1"># CVLow LSB of CV</span>
        <span class="c1"># Mode - service write mode</span>
        <span class="c1">#CVVal - CV value</span>
        <span class="s1">&#39;A2&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;WCVS&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Write CV in Service Mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,CVHigh_CVLow,Mode,CVVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the session number of the cab; &lt;Dat2&gt; is the MSB # of the CV to be written (supports CVs 1 - 65536); &lt;Dat3&gt; is the LSB # of the CV to be written; &lt;Dat4&gt; is the service write mode; &lt;Dat5&gt; is the CV value to be written; Sent to the command station to write a DCC CV in service mode.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;AB&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;HEARTB&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Heartbeat message from module&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,Sequence,Status,StatusBits&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Hearbeat message from module indicating alive. Sent every 5 seconds by module. Sequence count from 0, incrementing and wrap around to 0., Statis is binary representation of diagnostic status 0x00 is normal operation. StatusBits is reserved set to 0x00. VLCB new feature.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;AC&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Service discovery response&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,ServiceIndex,ServiceType,Version&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Version of service supported response to RQSD with ServiceIndex = 0. First SD response is number of following SD responses. Also see ESD. VLCB new feature.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;AF&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;GRSP&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Generic response&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,Opcode,ServiceType,Result&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Generic response for a config change request. Result byte indicates ok for success or error code. CMDERR codes are supported. VLCB new feature.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;B0&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACON1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory ON&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the high byte of the node number; &lt;Dat2&gt; is the low byte of the node number; &lt;Dat3&gt; is the high byte of the event number; &lt;Dat4&gt; is the low byte of the event number; &lt;Dat5&gt; is an additional data byte; Indicates an ON event using the full event number of; 4 bytes with one additional data byte.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;B1&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACOF1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory OFF&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; is the high byte of the node number; &lt;Dat2&gt; is the low byte of the node number; &lt;Dat3&gt; is the high byte of the event number; &lt;Dat4&gt; is the low byte of the event number; &lt;Dat5&gt; is an additional data byte; Indicates an OFF event using the full event number of 4 bytes with one additional data byte.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;B2&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;REQEV&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Read event variable in learn mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,EvIndex&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Allows a configuration tool to read stored event variables from a node. EV# is the EV index. Reply is (EVANS)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;B3&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARON1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON response event with one additional data byte. A response event is a reply to a status request (AREQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;B4&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;AROF1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an OFF response event with one additional data byte. A response event is a reply to a status request (AREQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="c1"># NNHigh, NNLow node replying</span>
        <span class="c1"># EvVal is value of Event Variable</span>
        <span class="s1">&#39;B5&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NEVAL&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Response to request for read of EV value&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnIndex,EvIndex,EvVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;NN is the node replying. EN# is the index of the event in that node. EV# is the index of the event variable. EVval is the value of that EV. This is response to 9C (REVAL)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;B6&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;PNN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Response to Query Node&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,ManufId,ModId,Flags&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;NN Hi&gt; is the high byte of the node number; &lt;NN Lo&gt; is the low byte of the node number; &lt;Manuf Id&gt; is the Manufacturer id as defined in the node parameters; &lt;Module Id&gt; is the Module Type Id id as defined in the node parameters; &lt;Flags&gt; is the node flags as defined in the node parameters. The Flags byte contains bit flags as follows:; Bit 0: Set to 1 for consumer node; Bit 1: Set to 1 for producer node; Bit 2: Set to 1 for FLiM mode; Bit 3: Set to 1 for Bootloader compatible; If a module is both a producer and a consumer then it is referred to as a combi node and; both flags will be set.; Every node should send this message in response to a QNN message.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;B8&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ASON1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short ON&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON event using the short event number of 2 LS bytes with one added data byte.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;B9&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ASOF1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short OFF&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an OFF event using the short event number of 2 LS bytes with one added data byte.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;BD&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARSON1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short Response Event with one data byte&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON response event with one added data byte. A response event is a reply to a status request (ASRQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;BE&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARSOF1&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory short response event with one data byte&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an OFF response event with one added data byte. A response event is a reply to a status request (ASRQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;BF&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EXTC4&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Extended op-code with 4 data bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;ExtOpc,Byte1,Byte2,Byte3,Byte4&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used if the basic set of 32 OPCs is not enough. Allows an additional 256 OPCs.&#39;</span><span class="p">},</span>
        <span class="c1"># 6 data byte packets</span>
        <span class="s1">&#39;C0&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RDCC5&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Requst 5-byte DCC packet&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Rep,Byte1,Byte2,Byte3,Byte4,Byte5&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1(REP)&gt; is # of repetitions in sending the packet.; &lt;Dat2&gt;..&lt;Dat6&gt; 5 bytes of the DCC packet.; Allows a CAB or equivalent to request a 5 byte DCC packet to be sent to the track. The packet is sent &lt;REP&gt; times and is not refreshed on a regular basis.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;C1&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;WCVOA&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Write CV (byte) in OPS mode by address&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;AddrHigh_AddrLow,CVHigh_CVLow,Mode,CVVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat1&gt; and &lt;Dat2&gt; are [AddrH] and [AddrL] of the decoder, respectively.; 7 bit addresses have (AddrH=0).; 14 bit addresses have bits 7,8 of AddrH set to 1.; &lt;Dat3&gt; is the MSB # of the CV to be written (supports CVs 1 - 65536); &lt;Dat4&gt; is the LSB # of the CV to be written; &lt;Dat5&gt; is the programming mode to be used; &lt;Dat6&gt; is the CV byte value to be written; Sent to the command station to write a DCC CV byte in OPS mode to specific loco (on the main). Used by computer based ops mode programmer that does not have a valid throttle handle.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;C2&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;CABDAT&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Send data to DCC CAB which is controlling loco&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;AddrHigh_AddrLow,DataCode,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Send data to DCC CAB controlling particular loco. CABSIG data1 for aspect1, data2 for aspect2, data3 for speed. Defined in RFC0005.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;C7&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DGN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Dianostic data resonse&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,ServiceIndex,DiagCode,DiagVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Diagnostic data value from a module sent in response to RDGN. VLCB new features&#39;</span><span class="p">},</span>
        <span class="s1">&#39;CF&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;FCLK&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Fast Clock&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;DateTime&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;This addendum defines a time encoding&#39;</span><span class="p">},</span>
        <span class="s1">&#39;D0&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACON2&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory ON&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1,Byte2&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON event using the full event number of 4 bytes with two additional data bytes.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;D1&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACOF2&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory OFF&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1,Byte2&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;ndicates an OFF event using the full event number of 4 bytes with two additional data bytes.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;D2&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EVLRN&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Teach an event in learn mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,EvIndex,EvVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;A node response to a request from a configuration tool for the EVs associated with an event (REQEV). For multiple EVs, there will be one response per request. VLCB also return GRSP.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;D3&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EVANS&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Response to a request for an EV value in a node in learn mode&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,EvIndex,EvVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;A node response to a request from a configuration tool for the EVs associated with an event (REQEV). For multiple EVs, there will be one response per request.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;D4&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARON2&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1,Byte2&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON response event with two added data bytes. A response event is a reply to a status request (AREQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;D5&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;AROF2&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1,Byte2&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an OFF response event with two added data bytes. A response event is a reply to a status request (AREQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;D8&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ASON2&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short ON&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1,Byte2&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON event using the short event number of 2 LS bytes with two added data bytes.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;DD&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARSON2&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short Response Event with two bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1,Byte2&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON response event with two added data bytes. A response event is a reply to a status request (ASRQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;DE&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARSOF2&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short Response Event with two bytes&#39;</span><span class="p">,</span><span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1,Byte2&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an OFF response event with two added data bytes. A response event is a reply to a status request (ASRQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;DF&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EXTC5&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Extended op-code with 5 data bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;ExtOpc,Byte1,Byte2,Byte3,Byte4,Byte5&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used if the basic set of 32 OPCs is not enough. Allows an additional 256 OPCs&#39;</span><span class="p">},</span>
         <span class="c1"># 7 data byte packets</span>
        <span class="s1">&#39;E0&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;RDCC6&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Request 6 byte DCC packet&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Rep,Byte1,Byte2,Byte3,Byte4,Byte5&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Allows a CAB or equivalent to request a 6 byte DCC packet to be sent to the track. The packet is sent &lt;REP&gt; times and is not refreshed on a regular basis.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;E1&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;PLOC&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Engine Report&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Session,AddrHigh_AddrLow,SpeedDir,Fn1,Fn2,Fn3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;Dat4&gt; is the Speed/Direction value. Bit 7 is the direction bit and bits 0-6 are the speed value.; &lt;Dat5&gt; is the function byte F0 to F4; &lt;Dat6&gt; is the function byte F5 to F8; &lt;Dat7&gt; is the function byte F9 to F12; A report of an engine entry sent by the command station. Sent in response to QLOC or as an acknowledgement of acquiring an engine requested by a cab (RLOC or GLOC).&#39;</span><span class="p">},</span>
        <span class="s1">&#39;E2&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Response to request for node name string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Char1_7&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;A node response while in setup mode for its name string. Reply to (RQMN). The string for the module type is returned in char1 to char7, space filled to 7 bytes. The Module Name prefix , currently either CAN or ETH, depends on the Interface Protocol parameter, it is not included in the response, see section 12.2 for the definition of the parameters.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;E3&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;STAT&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Command station status report&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,CSNum,Flags,MajRev,MinRev,Build&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;NN hi&gt; &lt;NN lo&gt; Gives node id of command station, so further info can be got from parameters or interrogating NVs; &lt;CS num&gt; For future expansion - set to zero at present; &lt;flags&gt; Flags as defined below; &lt;Major rev&gt; Major revision number; &lt;Minor rev&gt; Minor revision letter; &lt;Build no.&gt; Build number, always 0 for a released version.; &lt;flags&gt; is status defined by the bits below.; bits:; 0 - Hardware Error (self test); 1 - Track Error; 2 - Track On/ Off; 3 - Bus On/ Halted; 4 - EM. Stop all performed; 5 - Reset done; 6 - Service mode (programming) On/ Off; 7  reserved; Sent by the command station in response to RSTAT.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;E7&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ESD&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Extended service discovery response&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,ServiceIndex,ServiceType,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Detailed information about a service supported by a module. Sent in response to RQSD where ServiceIndex is not 0. VLCB new feature&#39;</span><span class="p">},</span>
        <span class="s1">&#39;E9&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DTXC&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Streaming protocol&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;StreamID,Sequence,Byte1,Byte2,Byte3,Byte4,Byte5&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used to transport relatively large block of data. StreamID is unique layout wide (&gt; 20). If Sequence num is 0x00 then bytes are MessageLen (2 bytes), CRC16 (2 bytes), Flags (1 byte reserved). Defined in RFC0005&#39;</span><span class="p">},</span>
        <span class="s1">&#39;EF&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;PARAMS&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Response to request for node parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;Para1_7&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;A node response while in setup mode for its parameter string. Reply to (RQNP)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F0&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACON3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory ON&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON event using the full event number of 4 bytes with three additional data bytes.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F1&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACOF3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory OFF&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an OFF event using the full event number of 4 bytes with three additional data bytes.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F2&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ENRSP&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Response to request to read node events&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,En3_0,EnIndex&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Where the NN is that of the sending node. EN3 to EN0 are the four bytes of the stored event. EN# is the index of the event within the sending node. This is a response to either 57 (NERD) or 72 (NENRD)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F3&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARON3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Acessory Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON response event with three added data bytes. A response event is a reply to a status request (AREQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F4&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;AROF3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Acessory Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON response event with three added data bytes. A response event is a reply to a status request (AREQ) without producing an ON or OFF event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F5&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EVLRNI&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Teach and event in learn mode using event indexing&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,EnHigh_EnLow,EnIndex,EvIndex,EvVal&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Sent by a configuration tool to a node in learn mode to teach it an event. The event index must be known. Also teaches it the associated event variables.(EVs). This command is repeated for each EV required. VLCB allow zero events and zero EVid, also return GRSP.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F6&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ACDAT&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory node data event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,Byte1,Byte2,Byte3,Byte4,Byte5&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an event from this node with 5 bytes of data. For example, this can be used to send the 40 bits of an RFID tag. There is no event number in order to allow space for 5 bytes of data in the packet, so there can only be one data event per node.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F7&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARDAT&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory node data response&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,Byte1,Byte2,Byte3,Byte4,Byte5&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates a node data response. A response event is a reply to a status request (RQDAT) without producing a new data event.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F8&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ASON3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short ON&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an ON event using the short event number of 2 LS bytes with three added data bytes.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;F9&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ASOF3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short OFF&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Indicates an OFF event using the short event number of 2 LS bytes with three added data bytes.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;FA&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DDES&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Device data event (short mode)&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;DNHigh_DNLow,Byte1,Byte2,Byte3,Byte4,Byte5&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Function is the same as F6 but uses device addressing so can relate data to a device attached to a node. e.g. one of several RFID readers attached to a single node.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;FB&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DDRS&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Device data response (short mode)&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;DNHigh_DNLow,Byte1,Byte2,Byte3,Byte4,Byte5&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;The response to a request for data from a device. (0x5B)&#39;</span><span class="p">},</span>
        <span class="s1">&#39;FC&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;DDWS&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Write data&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;DNHigh_DNLow,byte1,byte2,byte3,byte4,byte5&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used to write data to a device such as an RFID tag. For RC522 byte1 should be 0.&#39;</span><span class="p">},</span>
        <span class="s1">&#39;FD&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARSON3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s2">&quot;Indicates an ON response event with with three added data bytes. A response event is a reply to a status request (ASRQ) without producing an ON or OFF event.&quot;</span><span class="p">},</span>
        <span class="s1">&#39;FE&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;ARSOF3&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Accessory Short Response Event&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;NN,DNHigh_DNLow,Byte1,Byte2,Byte3&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s2">&quot;Indicates an OFF response event with with three added data bytes. A response event is a reply to a status request (ASRQ) without producing an ON or OFF event.&quot;</span><span class="p">},</span>
        <span class="s1">&#39;FF&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;opc&#39;</span><span class="p">:</span> <span class="s1">&#39;EXTC6&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Extended op-code with 6 data bytes&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;ExtOpc,Byte1,Byte2,Byte3,Byte4,Byte5,Byte6&#39;</span><span class="p">,</span> <span class="s1">&#39;minpri&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Used if the basic set of 32 OPCs is not enough. Allows an additional 256 OPCs&#39;</span><span class="p">}</span>
        <span class="p">}</span>

    <span class="c1"># Number of chars (2 per byte) in each field and how to show to use (eg. hex / num / char)</span>
    <span class="c1"># Num vs Hex is just suggested formatting - stored as a number the same</span>
    <span class="c1"># In char then it&#39;s ascii - otherwise normally convert to a number and return that</span>
    <span class="n">field_formats</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Unknown&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>        <span class="c1"># Generic if not known how to format</span>
            <span class="s2">&quot;CAN_ID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>         <span class="c1"># Canbus id</span>
            <span class="s2">&quot;Session&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>        <span class="c1"># Engine session number</span>
            <span class="s2">&quot;AddrHigh_AddrLow&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span> <span class="c1"># Address of dcoder (7 or 14 bit) - 14bit have bits 6,7 of AddrHigh set to 1</span>
            <span class="s2">&quot;Consist&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>        <span class="c1"># Consist ID</span>
            <span class="s2">&quot;Index&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>          <span class="c1"># Index of loco in consist</span>
            <span class="s2">&quot;Status&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>     
            <span class="s2">&quot;NN&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>    <span class="c1"># Node number</span>
            <span class="s2">&quot;AllocCode&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>       <span class="c1"># Specific allocation code</span>
            <span class="s2">&quot;SpeedDir&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>
            <span class="s2">&quot;SpeedFlag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>       <span class="c1"># Speed flags DDD-DDDDD</span>
            <span class="s2">&quot;Fnum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>            <span class="c1"># Function number</span>
            <span class="s2">&quot;Fn1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;num&quot;</span><span class="p">],</span>              <span class="c1"># Function number (multi byte)</span>
            <span class="s2">&quot;Fn2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;num&quot;</span><span class="p">],</span>              <span class="c1"># Function number (multi byte)</span>
            <span class="s2">&quot;Fn3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;num&quot;</span><span class="p">],</span>              <span class="c1"># Function number (multi byte)</span>
            <span class="s2">&quot;DNHigh_DNLow&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>    <span class="c1"># Device number (aka Device address)</span>
            <span class="s2">&quot;ExtOpc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;char&quot;</span><span class="p">],</span>         <span class="c1"># Extended op code</span>
            <span class="s2">&quot;Byte1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Byte (eg extended)</span>
            <span class="s2">&quot;Byte2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Byte (eg extended)</span>
            <span class="s2">&quot;Byte3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Byte (eg extended)</span>
            <span class="s2">&quot;Byte4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Byte (eg extended)</span>
            <span class="s2">&quot;Byte5&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Byte (eg extended)</span>
            <span class="s2">&quot;Byte6&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Byte (eg extended)</span>
            <span class="s2">&quot;CVHigh_CVLow&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>    <span class="c1"># CV number (DCC Configuration variables)</span>
            <span class="s2">&quot;CVVal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>           <span class="c1"># CV value </span>
            <span class="s2">&quot;NVIndex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>         <span class="c1"># NV Node variable index</span>
            <span class="s2">&quot;NVVal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># NV value</span>
            <span class="s2">&quot;NumEvents&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>       <span class="c1"># Number of events</span>
            <span class="s2">&quot;ParaIndex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>       <span class="c1"># Index of node parameter</span>
            <span class="s2">&quot;ParaVal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>         <span class="c1"># Value of node parameter</span>
            <span class="s2">&quot;Para1_7&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>        <span class="c1"># Multiple parameters</span>
            <span class="s2">&quot;EnHigh_EnLow&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>    <span class="c1"># En</span>
            <span class="s2">&quot;EnIndex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>         <span class="c1"># Index of Event</span>
            <span class="s2">&quot;EvIndex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>         <span class="c1"># Index of Event variable</span>
            <span class="s2">&quot;EvVal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>           <span class="c1"># Event variable value</span>
            <span class="s2">&quot;Rep&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>             <span class="c1"># Repeat, num of times to send signal</span>
            <span class="s2">&quot;Mode&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>            <span class="c1"># Service write mode</span>
            <span class="s2">&quot;ManufId&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>         <span class="c1"># Manufacturer</span>
            <span class="s2">&quot;ModId&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Module</span>
            <span class="s2">&quot;Flags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Module flags</span>
            <span class="s2">&quot;CSNum&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Zero (future expansion)</span>
            <span class="s2">&quot;MajRev&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>          <span class="c1"># Major revision number</span>
            <span class="s2">&quot;MinRev&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;ascii&quot;</span><span class="p">],</span>        <span class="c1"># Minor revision letter</span>
            <span class="s2">&quot;Build&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>           <span class="c1"># Built number always 0 for a released version</span>
            <span class="s2">&quot;DateTime&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>        <span class="c1"># Date and time encoded</span>
            <span class="s2">&quot;Char1_7&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;ascii&quot;</span><span class="p">],</span>      <span class="c1"># Name string 7 bytes long - padded</span>
            <span class="s2">&quot;En3_0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># 4 bytes of stored event</span>
            <span class="s2">&quot;EVSPC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>           <span class="c1"># Amount of space available for events</span>
            <span class="s2">&quot;ErrCode&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>         <span class="c1"># Short 1 byte error code</span>
            <span class="s2">&quot;Error&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>           <span class="c1"># Error code</span>
            <span class="s2">&quot;ModeCmd&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>         <span class="c1"># New VLCB mode command</span>
            <span class="s2">&quot;ServiceIndex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>    <span class="c1"># New VLCB Index of services</span>
            <span class="s2">&quot;DiagCode&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>        <span class="c1"># New VLCB Diagnostic data code</span>
            <span class="s2">&quot;DiagVal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>         <span class="c1"># New VLCB Diagnostic data value</span>
            <span class="s2">&quot;Sequence&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>        <span class="c1"># New VLCB Sequence number (also RFC0005 SequenceNum)</span>
            <span class="s2">&quot;StatusBits&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>      <span class="c1"># New VLCB StatusBits</span>
            <span class="s2">&quot;ServiceType&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>     <span class="c1"># New VLCB Service Type</span>
            <span class="s2">&quot;Version&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span>         <span class="c1"># New VLCB Version of service definition</span>
            <span class="s2">&quot;Opcode&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>          <span class="c1"># New VLCB Requested Opcode (in response)</span>
            <span class="s2">&quot;Result&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>          <span class="c1"># New VLCB Result from GRSP</span>
            <span class="s2">&quot;DataCode&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;hex&quot;</span><span class="p">],</span>        <span class="c1"># Used in CABDAT meaning of next 3 bytes</span>
            <span class="s2">&quot;StreamID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">]</span>         <span class="c1"># StreamID must be unique for the layout</span>
        <span class="p">}</span>

    <span class="c1"># Accessory Codes - provided for convenient lookup</span>
    <span class="n">accessory_codes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;on&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;ACON&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ASON&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ACON1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ACON2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ACON3&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ASON1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ASON2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ASON3&#39;</span>
            <span class="p">],</span>
        <span class="s1">&#39;off&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;ACOF&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ASOF&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ACOF1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ACOF2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ACOF3&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ASOF1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ASOF2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ASOF3&#39;</span>
            <span class="p">]</span>
        <span class="p">}</span>

    <span class="c1"># DCC error codes as byte string lookup</span>
    <span class="n">dcc_error_codes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;01&#39;</span><span class="p">:</span> <span class="s1">&#39;Loco stack full&#39;</span><span class="p">,</span>
        <span class="s1">&#39;02&#39;</span><span class="p">:</span> <span class="s1">&#39;Loco address taken&#39;</span><span class="p">,</span>
        <span class="s1">&#39;03&#39;</span><span class="p">:</span> <span class="s1">&#39;Session not present&#39;</span><span class="p">,</span>
        <span class="s1">&#39;04&#39;</span><span class="p">:</span> <span class="s1">&#39;Consist empty&#39;</span><span class="p">,</span>
        <span class="s1">&#39;05&#39;</span><span class="p">:</span> <span class="s1">&#39;Loco not found&#39;</span><span class="p">,</span>
        <span class="s1">&#39;06&#39;</span><span class="p">:</span> <span class="s1">&#39;CAN bus error&#39;</span><span class="p">,</span>
        <span class="s1">&#39;07&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid request&#39;</span><span class="p">,</span>
        <span class="s1">&#39;08&#39;</span><span class="p">:</span> <span class="s1">&#39;Session cancelled&#39;</span>
        <span class="p">}</span>

    <span class="c1"># CMDERR / GRSP error codes as byte string lookup</span>
    <span class="n">grsp_error_codes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;00&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span>
        <span class="s1">&#39;01&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid command&#39;</span><span class="p">,</span>
        <span class="s1">&#39;02&#39;</span><span class="p">:</span> <span class="s1">&#39;Not in learn mode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;03&#39;</span><span class="p">:</span> <span class="s1">&#39;Not in setup mode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;04&#39;</span><span class="p">:</span> <span class="s1">&#39;Too many events&#39;</span><span class="p">,</span>
        <span class="s1">&#39;05&#39;</span><span class="p">:</span> <span class="s1">&#39;No event&#39;</span><span class="p">,</span>
        <span class="s1">&#39;06&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid event variable index&#39;</span><span class="p">,</span>
        <span class="s1">&#39;07&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid event&#39;</span><span class="p">,</span>
        <span class="s1">&#39;08&#39;</span><span class="p">:</span> <span class="s1">&#39;Reserved&#39;</span><span class="p">,</span>
        <span class="s1">&#39;09&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid parameter index&#39;</span><span class="p">,</span>
        <span class="s1">&#39;0A&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid node variable index&#39;</span><span class="p">,</span>
        <span class="s1">&#39;0B&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid event variable value&#39;</span><span class="p">,</span>
        <span class="s1">&#39;0C&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid node variable value&#39;</span><span class="p">,</span>
        <span class="s1">&#39;0D&#39;</span><span class="p">:</span> <span class="s1">&#39;Other in learn mode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;FA&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid mode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;FB&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid command parameter&#39;</span><span class="p">,</span>
        <span class="s1">&#39;FC&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid service&#39;</span><span class="p">,</span>
        <span class="s1">&#39;FD&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid diagnostic&#39;</span><span class="p">,</span>
        <span class="s1">&#39;FE&#39;</span><span class="p">:</span> <span class="s1">&#39;Unknown NVM type&#39;</span><span class="p">,</span>
        <span class="s1">&#39;FF&#39;</span><span class="p">:</span> <span class="s1">&#39;Reserved&#39;</span>
        <span class="p">}</span>



    <span class="c1"># Shorten op-code (remove extra characters)</span>
    <span class="c1"># Used to allow methods to be used if mnemonic is included in op-code</span>
    <span class="c1"># Or you could pass the entire data section</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">opcode_extract</span> <span class="p">(</span><span class="n">opcode_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shortens op code by removing extra characters</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: shortened opcode string</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If string does not contain at least 2 characters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">opcode_string</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">opcode_string</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;String </span><span class="si">{</span><span class="n">opcode_string</span><span class="si">}</span><span class="s2"> is too short.&quot;</span><span class="p">)</span>

    <span class="c1"># Get min priority from opcode</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">opcode_priority</span> <span class="p">(</span><span class="n">opcode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get priority from opcode</span>

<span class="sd">        Returns:</span>
<span class="sd">            int: priority value</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If opcode not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opcode</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_extract</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;minpri&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="n">opcode</span><span class="si">}</span><span class="s2"> is not defined.&quot;</span><span class="p">)</span>

    <span class="c1"># Title of opcode (used in tooltip)</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">opcode_title</span> <span class="p">(</span><span class="n">opcode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get title from opcode</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: Opcode Title</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If opcode not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opcode</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_extract</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="n">opcode</span><span class="si">}</span><span class="s2"> is not defined.&quot;</span><span class="p">)</span>

    <span class="c1"># Convert op-code to mnemonic</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">opcode_mnemonic</span> <span class="p">(</span><span class="n">opcode</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get mnemonic from opcode</span>

<span class="sd">        Returns:</span>
<span class="sd">            String: Opcode mnemonic</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If opcode not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opcode</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_extract</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;opc&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="n">opcode</span><span class="si">}</span><span class="s2"> is not defined.&quot;</span><span class="p">)</span>

    <span class="c1"># Parse the data based on the format str and store in a dictionary</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parse_data</span> <span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpcodeData</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the data associated with the data string as a dict</span>

<span class="sd">        Returns:</span>
<span class="sd">            OpcodeData: Dict in OpcodeData format</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If opcode not found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Does not raise any explicit exceptions but uses methods that could raise a ValueError</span>
        <span class="n">opcode</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_extract</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># strip opcode from data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

        <span class="c1">#print (f&quot;Data {data}&quot;)</span>
        <span class="c1"># Include opcode in data if required for future use</span>
        <span class="n">data_parsed</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;opid&#39;</span><span class="p">:</span> <span class="n">opcode</span><span class="p">}</span>
        <span class="c1"># check valid opcode (if not then empty format)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">data_parsed</span><span class="p">[</span><span class="s1">&#39;opcode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;UNKNOWN&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;format&#39;</span><span class="p">]</span>
            <span class="n">data_parsed</span><span class="p">[</span><span class="s1">&#39;opcode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;opc&#39;</span><span class="p">]</span>
        <span class="n">format_fields</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="c1"># Remove data as added to dict so when reach 0 we are complete</span>
        <span class="c1"># parse each of the fields</span>
        <span class="k">for</span> <span class="n">this_field</span> <span class="ow">in</span> <span class="n">format_fields</span><span class="p">:</span>
            <span class="c1"># If no format then skip and add any data at end</span>
            <span class="k">if</span> <span class="n">this_field</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="c1"># If unknown then flag here - should only get this during unittests if a new format is added</span>
            <span class="k">if</span> <span class="n">this_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">field_formats</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning format field </span><span class="si">{</span><span class="n">this_field</span><span class="si">}</span><span class="s2"> not recognised&quot;</span><span class="p">)</span>
                <span class="n">this_field</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>
            <span class="c1"># Take number of bytes from remaining data</span>
            <span class="c1"># Check enough first - if not then add warning</span>
            <span class="n">num_chars</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">field_formats</span><span class="p">[</span><span class="n">this_field</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_chars</span> <span class="p">:</span>
                <span class="n">data_parsed</span><span class="p">[</span><span class="n">this_field</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Insufficient data </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="c1"># remove remaining</span>
                <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Move number of chars (typically 2 chars per byte) into this_val</span>
                <span class="n">this_val</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_chars</span><span class="p">]</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">num_chars</span><span class="p">:]</span>
                <span class="c1"># if number expected then convert</span>
                <span class="k">if</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">field_formats</span><span class="p">[</span><span class="n">this_field</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;char&quot;</span><span class="p">:</span>
                    <span class="n">this_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">this_val</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
                <span class="n">data_parsed</span><span class="p">[</span><span class="n">this_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_val</span>
        <span class="c1"># remaining data added to final field (shouldn&#39;t normally get this)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">data_parsed</span><span class="p">[</span><span class="s2">&quot;ExtraData&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">data_parsed</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBOpcode.opcode_extract" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">opcode_extract</span><span class="p">(</span><span class="n">opcode_string</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Shortens op code by removing extra characters</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shortened opcode string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If string does not contain at least 2 characters</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">opcode_extract</span> <span class="p">(</span><span class="n">opcode_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shortens op code by removing extra characters</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: shortened opcode string</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If string does not contain at least 2 characters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">opcode_string</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">opcode_string</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;String </span><span class="si">{</span><span class="n">opcode_string</span><span class="si">}</span><span class="s2"> is too short.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBOpcode.opcode_mnemonic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">opcode_mnemonic</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get mnemonic from opcode</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Opcode mnemonic</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If opcode not found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">opcode_mnemonic</span> <span class="p">(</span><span class="n">opcode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get mnemonic from opcode</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: Opcode mnemonic</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If opcode not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opcode</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_extract</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;opc&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="n">opcode</span><span class="si">}</span><span class="s2"> is not defined.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBOpcode.opcode_priority" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">opcode_priority</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get priority from opcode</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>priority value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If opcode not found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">opcode_priority</span> <span class="p">(</span><span class="n">opcode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get priority from opcode</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: priority value</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If opcode not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opcode</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_extract</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;minpri&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="n">opcode</span><span class="si">}</span><span class="s2"> is not defined.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBOpcode.opcode_title" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">opcode_title</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Get title from opcode</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Opcode Title</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If opcode not found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">opcode_title</span> <span class="p">(</span><span class="n">opcode</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get title from opcode</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: Opcode Title</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If opcode not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opcode</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_extract</span><span class="p">(</span><span class="n">opcode</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opcode </span><span class="si">{</span><span class="n">opcode</span><span class="si">}</span><span class="s2"> is not defined.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.VLCBOpcode.parse_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Returns the data associated with the data string as a dict</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>OpcodeData</code></td>            <td>
                  <code><span title="pyvlcb.vlcbformat.OpcodeData">OpcodeData</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict in OpcodeData format</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If opcode not found</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/vlcbformat.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parse_data</span> <span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OpcodeData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the data associated with the data string as a dict</span>

<span class="sd">    Returns:</span>
<span class="sd">        OpcodeData: Dict in OpcodeData format</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If opcode not found</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Does not raise any explicit exceptions but uses methods that could raise a ValueError</span>
    <span class="n">opcode</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcode_extract</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># strip opcode from data</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>

    <span class="c1">#print (f&quot;Data {data}&quot;)</span>
    <span class="c1"># Include opcode in data if required for future use</span>
    <span class="n">data_parsed</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;opid&#39;</span><span class="p">:</span> <span class="n">opcode</span><span class="p">}</span>
    <span class="c1"># check valid opcode (if not then empty format)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">opcode</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">data_parsed</span><span class="p">[</span><span class="s1">&#39;opcode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;UNKNOWN&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">format</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;format&#39;</span><span class="p">]</span>
        <span class="n">data_parsed</span><span class="p">[</span><span class="s1">&#39;opcode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">opcodes</span><span class="p">[</span><span class="n">opcode</span><span class="p">][</span><span class="s1">&#39;opc&#39;</span><span class="p">]</span>
    <span class="n">format_fields</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="c1"># Remove data as added to dict so when reach 0 we are complete</span>
    <span class="c1"># parse each of the fields</span>
    <span class="k">for</span> <span class="n">this_field</span> <span class="ow">in</span> <span class="n">format_fields</span><span class="p">:</span>
        <span class="c1"># If no format then skip and add any data at end</span>
        <span class="k">if</span> <span class="n">this_field</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="c1"># If unknown then flag here - should only get this during unittests if a new format is added</span>
        <span class="k">if</span> <span class="n">this_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">field_formats</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning format field </span><span class="si">{</span><span class="n">this_field</span><span class="si">}</span><span class="s2"> not recognised&quot;</span><span class="p">)</span>
            <span class="n">this_field</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>
        <span class="c1"># Take number of bytes from remaining data</span>
        <span class="c1"># Check enough first - if not then add warning</span>
        <span class="n">num_chars</span> <span class="o">=</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">field_formats</span><span class="p">[</span><span class="n">this_field</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_chars</span> <span class="p">:</span>
            <span class="n">data_parsed</span><span class="p">[</span><span class="n">this_field</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Insufficient data </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="c1"># remove remaining</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Move number of chars (typically 2 chars per byte) into this_val</span>
            <span class="n">this_val</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num_chars</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">num_chars</span><span class="p">:]</span>
            <span class="c1"># if number expected then convert</span>
            <span class="k">if</span> <span class="n">VLCBOpcode</span><span class="o">.</span><span class="n">field_formats</span><span class="p">[</span><span class="n">this_field</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;char&quot;</span><span class="p">:</span>
                <span class="n">this_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">this_val</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
            <span class="n">data_parsed</span><span class="p">[</span><span class="n">this_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">this_val</span>
    <span class="c1"># remaining data added to final field (shouldn&#39;t normally get this)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">data_parsed</span><span class="p">[</span><span class="s2">&quot;ExtraData&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">return</span> <span class="n">data_parsed</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="pyvlcb.utils"></a>
    <div class="doc doc-contents first">

        <p>Utils for use by other parts of the library</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="pyvlcb.utils.bytes_to_addr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bytes_to_addr</span><span class="p">(</span><span class="n">byte1</span><span class="p">,</span> <span class="n">byte2</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert 2 byte values into an address id sring</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>byte1</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Most significant byte</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>byte2</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Least significant byte</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The address id value</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bytes_to_addr</span> <span class="p">(</span><span class="n">byte1</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">byte2</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert 2 byte values into an address id sring</span>

<span class="sd">    Args:</span>
<span class="sd">        byte1 (bytes): Most significant byte</span>
<span class="sd">        byte2 (bytes): Least significant byte</span>

<span class="sd">    Returns:</span>
<span class="sd">        Int: The address id value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">msb</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">byte1</span><span class="p">)</span>
    <span class="n">lsb</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">byte2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">msb</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">lsb</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.utils.bytes_to_functions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bytes_to_functions</span><span class="p">(</span><span class="n">fn1</span><span class="p">,</span> <span class="n">fn2</span><span class="p">,</span> <span class="n">fn3</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Sets the value of the functions from a PLOC message
Only returns values for F0 to F12 (others not included in PLOC)
Provides as a list for inclusion in menus etc.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fn1</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function byte F0 to F4 - bit 5 = dir lighting (F0), bit 6 = direction, bit 7 = res, bit 8 = 0</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fn2</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function byte F5 to F8 - bit 5 upwards reserved</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fn3</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function byte F9 to F12</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of function values as 0 or 1 for each function as off and on</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bytes_to_functions</span> <span class="p">(</span><span class="n">fn1</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">fn2</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">fn3</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Sets the value of the functions from a PLOC message</span>
<span class="sd">    Only returns values for F0 to F12 (others not included in PLOC)</span>
<span class="sd">    Provides as a list for inclusion in menus etc.</span>

<span class="sd">    Args:</span>
<span class="sd">        fn1: Function byte F0 to F4 - bit 5 = dir lighting (F0), bit 6 = direction, bit 7 = res, bit 8 = 0</span>
<span class="sd">        fn2: Function byte F5 to F8 - bit 5 upwards reserved</span>
<span class="sd">        fn3: Function byte F9 to F12</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of function values as 0 or 1 for each function as off and on</span>

<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">data_in</span> <span class="o">=</span> <span class="p">[</span><span class="n">fn1</span><span class="p">,</span> <span class="n">fn2</span><span class="p">,</span> <span class="n">fn3</span><span class="p">]</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="mb">0b0001</span><span class="p">,</span> <span class="mb">0b0010</span><span class="p">,</span> <span class="mb">0b0100</span><span class="p">,</span> <span class="mb">0b1000</span><span class="p">]</span>
    <span class="n">function_status</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">29</span>
    <span class="c1"># Handle 0 separately as it&#39;s in the upper nibble</span>
    <span class="n">function_status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_in</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b10000</span>
    <span class="c1"># Create a list of 12 entries</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">function_status</span><span class="p">[(</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">data_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">function_status</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.utils.bytes_to_hexstr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bytes_to_hexstr</span><span class="p">(</span><span class="n">byte1</span><span class="p">,</span> <span class="n">byte2</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert 2 bytes to a hex string</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>byte1</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Most significant byte</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>byte2</code>
            </td>
            <td>
                  <code><span title="bytes">bytes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Least significant byte</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A hex representation of the number</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bytes_to_hexstr</span> <span class="p">(</span><span class="n">byte1</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">byte2</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert 2 bytes to a hex string</span>

<span class="sd">    Args:</span>
<span class="sd">        byte1 (bytes): Most significant byte</span>
<span class="sd">        byte2 (bytes): Least significant byte</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A hex representation of the number</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">byte1</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span><span class="si">:</span><span class="s2">0&gt;2</span><span class="si">}{</span><span class="nb">hex</span><span class="p">(</span><span class="n">byte2</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span><span class="si">:</span><span class="s2">0&gt;2</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.utils.dict_to_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dict_to_string</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert a dict to a string without {} or quotes</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dict_to_string</span> <span class="p">(</span><span class="n">dictionary</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert a dict to a string without {} or quotes &quot;&quot;&quot;</span>
    <span class="n">data_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">data_string</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">data_string</span> <span class="o">+=</span> <span class="s2">&quot; , &quot;</span>
        <span class="n">data_string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="n">data_string</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.utils.f_to_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">f_to_bytes</span><span class="p">(</span><span class="n">f_num</span><span class="p">,</span> <span class="n">function_status</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert a Fnumber (Loco function ID) to bytes as string representation</p>
<p>Can be used to create correct format for loco_set_dfun
Limited to range 0 to 28 - which is max for DFUN
Higher would need to use DFNON/DFOFF</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f_num</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function number</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>function_status</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List with value of all functions (must be updated before calling)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of two x 2-characer strings representing the bytes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Raises: ValueError</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">f_to_bytes</span> <span class="p">(</span><span class="n">f_num</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">function_status</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Convert a Fnumber (Loco function ID) to bytes as string representation</span>

<span class="sd">    Can be used to create correct format for loco_set_dfun</span>
<span class="sd">    Limited to range 0 to 28 - which is max for DFUN</span>
<span class="sd">    Higher would need to use DFNON/DFOFF</span>

<span class="sd">    Args:</span>
<span class="sd">        f_num: Function number</span>
<span class="sd">        function_status: List with value of all functions (must be updated before calling)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of two x 2-characer strings representing the bytes</span>

<span class="sd">    Raises: ValueError</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Must be an F number between 0 and 28</span>
    <span class="k">if</span> <span class="n">f_num</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">f_num</span> <span class="o">&gt;</span> <span class="mi">28</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fnumber needs to be between 0 and 28. Number provided </span><span class="si">{</span><span class="n">f_num</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Extend function_status to 29 entries</span>
    <span class="n">function_list</span> <span class="o">=</span> <span class="n">function_status</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">29</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">function_status</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">f_num</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">byte1</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">byte2</span> <span class="o">=</span> <span class="p">(</span><span class="mb">0b10000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>  <span class="c1"># fn0 is higher nibble (bit 5)</span>
                 <span class="mb">0b0001</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0010</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0100</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b1000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                 <span class="p">)</span>
    <span class="k">elif</span> <span class="n">f_num</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">:</span>
        <span class="n">byte1</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">byte2</span> <span class="o">=</span> <span class="p">(</span><span class="mb">0b0001</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0010</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0100</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b1000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
                 <span class="p">)</span>
    <span class="k">elif</span> <span class="n">f_num</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">:</span>
        <span class="n">byte1</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">byte2</span> <span class="o">=</span> <span class="p">(</span><span class="mb">0b0001</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0010</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0100</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b1000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>
                 <span class="p">)</span>
    <span class="k">elif</span> <span class="n">f_num</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">:</span>
        <span class="n">byte1</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">byte2</span> <span class="o">=</span> <span class="p">(</span><span class="mb">0b0001</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0010</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0100</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b1000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b10000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b100000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b1000000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b10000000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span>
                 <span class="p">)</span>
    <span class="k">elif</span> <span class="n">f_num</span> <span class="o">&lt;=</span> <span class="mi">28</span><span class="p">:</span>
        <span class="n">byte1</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">byte2</span> <span class="o">=</span> <span class="p">(</span><span class="mb">0b0001</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0010</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b0100</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b1000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b10000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b100000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b1000000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">+</span>
                 <span class="mb">0b10000000</span> <span class="o">*</span> <span class="n">function_list</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span>
                 <span class="p">)</span>
    <span class="c1"># convert to strings before returning</span>
    <span class="c1"># and with 0xFF guarentees it doesn&#39;t overflow (although not really neccessary for this method)</span>
    <span class="n">str1</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="w"> </span><span class="p">(</span><span class="n">byte1</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">)</span><span class="w"> </span><span class="si">:</span><span class="s2">02x</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">str2</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="w"> </span><span class="p">(</span><span class="n">byte2</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">)</span><span class="w"> </span><span class="si">:</span><span class="s2">02x</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">str1</span><span class="p">,</span> <span class="n">str2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.utils.num_to_1hexstr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_to_1hexstr</span><span class="p">(</span><span class="n">num</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert number to a byte</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number to convert</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A hex representation of the number (2 chars)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">num_to_1hexstr</span> <span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert number to a byte</span>

<span class="sd">    Args:</span>
<span class="sd">        num (int): Number to convert</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A hex representation of the number (2 chars)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span><span class="si">:</span><span class="s2">0&gt;2</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.utils.num_to_2hexstr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_to_2hexstr</span><span class="p">(</span><span class="n">num</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert number to 2 bytes</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number to convert</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A hex representation of the number (4 chars)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">num_to_2hexstr</span> <span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert number to 2 bytes</span>

<span class="sd">    Args:</span>
<span class="sd">        num (int): Number to convert</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A hex representation of the number (4 chars)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span><span class="si">:</span><span class="s2">0&gt;4</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pyvlcb.utils.num_to_4hexstr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_to_4hexstr</span><span class="p">(</span><span class="n">num</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Convert number to 4 bytes</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number to convert</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>String</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A hex representation of the number (8 chars)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/pyvlcb/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">num_to_4hexstr</span> <span class="p">(</span><span class="n">num</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert number to 4 bytes</span>

<span class="sd">    Args:</span>
<span class="sd">        num (int): Number to convert</span>

<span class="sd">    Returns:</span>
<span class="sd">        String: A hex representation of the number (8 chars)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]</span><span class="si">:</span><span class="s2">0&gt;8</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>